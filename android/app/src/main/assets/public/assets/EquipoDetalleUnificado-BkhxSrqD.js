import{c as J,j as e,m as he,r as o,b as ue,X as pe}from"./index-C_D-5Bfv.js";import{u as je}from"./useHistorial-CCPwivlN.js";import{g as f,h as C,k as M,W as G,j as b,l as le,S as fe,P as O,B as i,A as ge,T as Ne,Y as P,D as be,o as ve,p as ye,q as we,f as ce,H as V,m as Se,Z as I,X as Ce}from"./card-BIr-PJK2.js";import{T as Me,a as ke,b as B,c as q}from"./tabs-KnLULWOS.js";import{B as Ke,C as Le}from"./index-BtotK06U.js";import{L as Re}from"./label-CqFCS6R-.js";import{A as Ae,a as De,b as Ie,c as ze}from"./accordion-CavA7SNR.js";import{u as me}from"./useCaterpillarData-DbqCupgf.js";import{g as Z,f as Y}from"./maintenanceUtils-fNWGA9SH.js";import{u as xe}from"./usePlanes-D-d8Ujwc.js";import{S as Te,a as Ee,b as Pe,c as _e,d as $e}from"./select-3Jn5ARjr.js";import{S as He}from"./sparkles-CBL8q4dG.js";import{f as X}from"./format-B1dMESlT.js";import{T as oe}from"./trending-up-Hw4Rtp_f.js";import{A as Fe}from"./activity-DZxii9vr.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=J("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=J("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=J("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);function Be({modelo:x,numeroSerie:y,marca:k,mantenimientos:h}){const{data:z,loading:T}=me(x,y);if(k.toLowerCase()!=="caterpillar"&&k.toLowerCase()!=="cat")return null;if(T)return e.jsxs(f,{children:[e.jsx(C,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Informaci√≥n Caterpillar"]})}),e.jsx(b,{className:"flex items-center justify-center py-8",children:e.jsx(he,{className:"h-6 w-6 animate-spin text-muted-foreground"})})]});if(!z.modelo)return e.jsx(f,{className:"border-amber-200/50 bg-amber-50/30",children:e.jsxs(C,{children:[e.jsxs(M,{className:"flex items-center gap-2 text-amber-800",children:[e.jsx(G,{className:"h-5 w-5"}),"Informaci√≥n Caterpillar"]}),e.jsxs(le,{children:["No se encontraron datos t√©cnicos Caterpillar para el modelo ",x]})]})});const{modelo:a,intervalos:K,piezasPorIntervalo:m,tareasPorIntervalo:L,mantenimientosEspeciales:w}=z,R=(t,n)=>{if(!(h!=null&&h.length))return null;const d=h.find(g=>g.frecuencia?Math.abs(g.frecuencia-n)<=Math.max(25,n*.1):!1);return d||h.find(g=>{var j;return(j=g.tipoMantenimiento)==null?void 0:j.toLowerCase().includes(t.toLowerCase())})};return e.jsxs(f,{className:"border-amber-200/70 bg-gradient-to-br from-amber-50/50 to-background",children:[e.jsxs(C,{children:[e.jsxs(M,{className:"flex items-center gap-2 text-amber-900",children:[e.jsx(G,{className:"h-5 w-5"}),"Plan de Mantenimiento Caterpillar"]}),e.jsxs(le,{children:["Intervalos PM y especificaciones t√©cnicas para ",a.modelo]})]}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border border-amber-200/60 bg-white/70 p-4",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-amber-900",children:"Especificaciones T√©cnicas"}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Motor"}),e.jsx("p",{className:"font-medium",children:a.motor})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aceite Motor"}),e.jsxs("p",{className:"font-medium",children:[a.capacidad_aceite_motor,"L"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sistema Hidr√°ulico"}),e.jsxs("p",{className:"font-medium",children:[a.capacidad_hidraulico,"L"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Refrigerante"}),e.jsxs("p",{className:"font-medium",children:[a.capacidad_refrigerante,"L"]})]})]})]}),a.serie_desde&&e.jsxs("div",{className:"mt-3 rounded-md bg-amber-100/50 p-2 text-xs text-amber-800",children:[e.jsx("strong",{children:"Serie:"})," ",a.serie_desde,a.serie_hasta&&` - ${a.serie_hasta}`,a.notas&&` ‚Ä¢ ${a.notas}`]})]}),e.jsx(fe,{className:"bg-amber-200/50"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-3 flex items-center gap-2 text-sm font-semibold text-amber-900",children:[e.jsx(O,{className:"h-4 w-4"}),"Intervalos de Mantenimiento Programado"]}),e.jsx(Ae,{type:"single",collapsible:!0,className:"space-y-2",children:K.map(t=>{const n=m[t.codigo]||[],d=L[t.codigo]||[],g=R(t.codigo,t.horas_intervalo),j=(g==null?void 0:g.horasKmRestante)??null;return e.jsxs(De,{value:`interval-${t.id}`,className:"rounded-lg border border-amber-200/60 bg-white/70 px-4",children:[e.jsx(Ie,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex w-full items-center justify-between pr-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{variant:"outline",className:"bg-amber-100 text-amber-800",children:t.codigo}),e.jsx("span",{className:"font-medium",children:t.nombre})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsx(i,{variant:Z(j),children:Y(j)}),e.jsxs(i,{variant:"secondary",children:[t.horas_intervalo,"h"]})]})]})}),e.jsx(ze,{className:"pt-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t.descripcion}),d.length>0&&e.jsxs("div",{className:"rounded-md border border-amber-200/40 bg-amber-50/50 p-3",children:[e.jsxs("p",{className:"mb-2 flex items-center gap-2 text-xs font-semibold text-amber-800",children:[e.jsx(ge,{className:"h-3.5 w-3.5"})," Tareas recomendadas"]}),e.jsx("ul",{className:"space-y-2 text-xs",children:d.map(N=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-amber-500"}),e.jsx("span",{className:"text-amber-900",children:N})]},N))})]}),n.length>0&&e.jsxs("div",{className:"rounded-md border border-amber-200/40 bg-amber-50/50 p-3",children:[e.jsx("p",{className:"mb-2 text-xs font-semibold text-amber-800",children:"Kits y Piezas Requeridas:"}),e.jsx("div",{className:"space-y-2",children:n.map(N=>e.jsxs("div",{className:"flex items-start justify-between gap-2 text-xs",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-amber-900",children:N.pieza.numero_parte}),e.jsx("p",{className:"text-muted-foreground",children:N.pieza.descripcion}),e.jsx(i,{variant:"outline",className:"mt-1 text-[10px]",children:N.pieza.tipo})]}),e.jsxs(i,{variant:"secondary",className:"shrink-0",children:["x",N.cantidad]})]},N.id))})]}),n.length===0&&e.jsx("p",{className:"text-xs italic text-muted-foreground",children:"No hay c√≥digos de pieza configurados para este intervalo."})]})})]},t.id)})})]}),w.length>0&&e.jsxs("div",{className:"space-y-3 rounded-lg border border-amber-200/60 bg-white/70 p-4",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-sm font-semibold text-amber-900",children:[e.jsx(Ne,{className:"h-4 w-4"})," Intervenciones especializadas"]}),e.jsx("ul",{className:"space-y-2 text-xs text-amber-900",children:w.map(t=>{var n;return e.jsxs("li",{className:"rounded-md border border-amber-200/50 bg-amber-50/40 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx(i,{variant:"outline",className:"bg-amber-100 text-amber-700",children:t.intervaloCodigo}),t.responsableSugerido&&e.jsx(i,{variant:"secondary",children:t.responsableSugerido})]}),e.jsx("p",{className:"mt-2 leading-relaxed text-amber-900",children:t.descripcion}),t.referencia&&e.jsxs("p",{className:"mt-2 text-[11px] text-muted-foreground",children:["Referencia: ",t.referencia]}),(n=t.adjuntos)!=null&&n.length?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.adjuntos.map(d=>e.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-amber-800 underline",children:d.label},d.label))}):null]},t.id)})})]}),e.jsxs("div",{className:"rounded-lg border border-amber-300/50 bg-amber-100/40 p-3 text-xs text-amber-800",children:[e.jsx("strong",{children:"üí° Nota:"})," Estos son intervalos recomendados por Caterpillar. Consulta el manual OMM espec√≠fico de tu equipo o"," ",e.jsx("a",{href:"https://parts.cat.com",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline",children:"parts.cat.com"})," ","para confirmar c√≥digos de pieza actualizados seg√∫n tu n√∫mero de serie."]})]})]})}function qe(x,y,k,h,z){const{planes:T}=xe();return o.useMemo(()=>{if(!x||!y||!k)return{intervaloSugerido:null,planEncontrado:null,razon:"Faltan datos del equipo (marca, modelo o categor√≠a)"};const K=T.find(n=>{var N;const d=n.marca.toLowerCase()===x.toLowerCase(),g=((N=n.modelo)==null?void 0:N.toLowerCase())===y.toLowerCase(),j=n.categoria.toLowerCase()===k.toLowerCase();return d&&g&&j&&n.activo});if(!K)return{intervaloSugerido:null,planEncontrado:null,razon:`No se encontr√≥ plan de mantenimiento para ${x} ${y} (${k})`};const m=h-z,L=[...K.intervalos].sort((n,d)=>n.horas_intervalo-d.horas_intervalo),w=L[L.length-1];if(m>=w.horas_intervalo)return{intervaloSugerido:w,planEncontrado:K,razon:`Han transcurrido ${m} horas desde el √∫ltimo mantenimiento. Se sugiere ${w.nombre}`};const R=L.find(n=>m<=n.horas_intervalo&&m>=n.horas_intervalo-50)||L.find(n=>m<n.horas_intervalo);if(R){const n=R.horas_intervalo-m;return{intervaloSugerido:R,planEncontrado:K,razon:n<=0?`El mantenimiento ${R.nombre} est√° vencido`:`Faltan aproximadamente ${n} horas para ${R.nombre}`}}const t=L[0];return{intervaloSugerido:t,planEncontrado:K,razon:`Equipo reci√©n agregado o sin suficientes horas. Se sugiere ${t.nombre}`}},[T,x,y,k,h,z])}function ls({ficha:x,open:y,onOpenChange:k}){var ie;const{data:h}=ue(),{eventos:z}=je(),{planes:T}=xe(),[a,K]=o.useState(null),[m,L]=o.useState([]),[w,R]=o.useState([]),[t,n]=o.useState([]),[d,g]=o.useState([]),[j,N]=o.useState([]),[_,Q]=o.useState(null),ee=o.useMemo(()=>{var s,l;return((s=a==null?void 0:a.marca)==null?void 0:s.toLowerCase().includes("caterpillar"))||((l=a==null?void 0:a.marca)==null?void 0:l.toLowerCase().includes("cat"))},[a]),{data:u}=me(ee?(a==null?void 0:a.modelo)??"":"",ee?(a==null?void 0:a.numeroSerie)??"":""),r=o.useMemo(()=>m.length?[...m].sort((s,l)=>s.horasKmRestante-l.horasKmRestante)[0]:null,[m]),E=o.useMemo(()=>d.length===0?null:d[d.length-1],[d]),A=o.useMemo(()=>j.length===0?null:j[j.length-1],[j]),se=(A==null?void 0:A.horasKm)||(r==null?void 0:r.horasKmActuales)||0,W=(E==null?void 0:E.horasKmAlMomento)||0,$=qe(a==null?void 0:a.marca,a==null?void 0:a.modelo,a==null?void 0:a.categoria,se,W),S=o.useMemo(()=>!(a!=null&&a.marca)||!(a!=null&&a.modelo)||!(a!=null&&a.categoria)?null:T.find(s=>{var U;const l=s.marca.toLowerCase()===a.marca.toLowerCase(),D=((U=s.modelo)==null?void 0:U.toLowerCase())===a.modelo.toLowerCase(),H=s.categoria.toLowerCase()===a.categoria.toLowerCase();return l&&D&&H&&s.activo}),[T,a]),c=o.useMemo(()=>_&&S&&S.intervalos.find(s=>s.id.toString()===_)||$.intervaloSugerido,[_,S,$.intervaloSugerido]),v=o.useMemo(()=>{var D;if(c)return c.codigo;if(!r)return null;const s=(D=r.tipoMantenimiento)==null?void 0:D.match(/(PM\d)/i);if(s!=null&&s[1])return s[1].toUpperCase();const l=r.frecuencia??0;return l<=0?null:l<=250?"PM1":l<=500?"PM2":l<=1e3?"PM3":l<=2e3?"PM4":null},[c,r]),ae=o.useMemo(()=>c&&c.kits&&c.kits.length>0?c.kits.flatMap(s=>s.kit.piezas||[]):!v||!(u!=null&&u.piezasPorIntervalo)?[]:u.piezasPorIntervalo[v]??[],[c,v,u]),re=o.useMemo(()=>c&&c.tareas&&c.tareas.length>0?c.tareas:!v||!(u!=null&&u.tareasPorIntervalo)?[]:u.tareasPorIntervalo[v]??[],[c,v,u]),te=o.useMemo(()=>{if(c)return c.descripcion;if(!v||!(u!=null&&u.intervalos))return null;const s=u.intervalos.find(l=>l.codigo===v);return(s==null?void 0:s.descripcion)??null},[c,v,u]);if(o.useMemo(()=>{if(!(r!=null&&r.fechaUltimaActualizacion))return"Sin registro reciente";const s=new Date(r.fechaUltimaActualizacion);return Number.isNaN(s.getTime())?"Sin registro reciente":P(s,{addSuffix:!0,locale:I})},[r]),o.useMemo(()=>(r==null?void 0:r.horasKmActuales)===null||(r==null?void 0:r.horasKmActuales)===void 0?"Sin lectura registrada":`${r.horasKmActuales} horas/km`,[r]),o.useEffect(()=>{if(x&&y){const s=h.equipos.find(p=>p.ficha===x);K(s);const l=h.mantenimientosProgramados.filter(p=>p.ficha===x);if(L(l),s){const p=h.inventarios.filter(F=>F.categoriaEquipo===s.categoria);R(p)}const D=z.filter(p=>p.fichaEquipo===x);n(D);const H=h.mantenimientosRealizados.filter(p=>p.ficha===x).sort((p,F)=>new Date(p.fechaMantenimiento).getTime()-new Date(F.fechaMantenimiento).getTime());g(H);const U=h.actualizacionesHorasKm.filter(p=>p.ficha===x).sort((p,F)=>new Date(p.fecha).getTime()-new Date(F.fecha).getTime());N(U)}},[x,y,h,z]),!a)return null;const ne=m.some(s=>s.horasKmRestante<0);return m.some(s=>s.horasKmRestante>0&&s.horasKmRestante<=50),e.jsx(be,{open:y,onOpenChange:k,children:e.jsxs(ve,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(we,{className:"text-2xl flex items-center gap-2",children:[e.jsx(ce,{className:"h-6 w-6"}),a.nombre]}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["Ficha: ",a.ficha]})]}),e.jsx(i,{variant:a.activo?"default":"secondary",children:a.activo?"Activo":"Inactivo"})]})}),e.jsxs(Me,{defaultValue:"general",className:"w-full",children:[e.jsxs(ke,{className:"grid w-full grid-cols-4",children:[e.jsxs(B,{value:"general",className:"gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"General"]}),e.jsxs(B,{value:"mantenimiento",className:"gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Mantenimientos",ne&&e.jsx(i,{variant:"destructive",className:"ml-1 h-5 w-5 p-0 flex items-center justify-center",children:"!"})]}),e.jsxs(B,{value:"inventario",className:"gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Repuestos"]}),e.jsxs(B,{value:"historial",className:"gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Historial"]})]}),e.jsxs(q,{value:"general",className:"space-y-4",children:[(c||S)&&e.jsxs(f,{className:"border border-primary/30 bg-primary/5",children:[e.jsxs(C,{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs(M,{className:"text-lg flex items-center gap-2 text-primary",children:[e.jsx(He,{className:"h-5 w-5"})," Pr√≥xima intervenci√≥n programada"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:$.razon}),S&&e.jsxs("p",{className:"text-xs text-muted-foreground/80",children:["Plan: ",S.nombre]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v&&e.jsx(i,{variant:"outline",className:"border-primary/40 bg-primary/10 text-primary",children:v}),r&&e.jsx(i,{variant:Z(r.horasKmRestante),children:Y(r.horasKmRestante,r.tipoMantenimiento==="Kil√≥metros"?"km":"horas")})]})]}),S&&S.intervalos.length>0&&e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-primary/20",children:[e.jsx(Re,{htmlFor:"intervalo-select",className:"text-sm font-medium whitespace-nowrap",children:"Cambiar intervalo:"}),e.jsxs(Te,{value:_||((ie=$.intervaloSugerido)==null?void 0:ie.id.toString())||"",onValueChange:s=>Q(s),children:[e.jsx(Ee,{id:"intervalo-select",className:"w-[280px]",children:e.jsx(Pe,{placeholder:"Seleccionar intervalo"})}),e.jsx(_e,{children:S.intervalos.map(s=>e.jsxs($e,{value:s.id.toString(),children:[s.nombre," (",s.horas_intervalo,"h)"]},s.id))})]}),_&&e.jsxs(Ke,{variant:"ghost",size:"sm",onClick:()=>Q(null),className:"text-xs",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"Restaurar sugerencia"]})]})]}),e.jsxs(b,{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-primary/70",children:"Servicio asignado"}),e.jsx("p",{className:"text-sm font-semibold text-primary",children:(c==null?void 0:c.nombre)||(r==null?void 0:r.tipoMantenimiento)||"Mantenimiento programado"}),te&&e.jsx("p",{className:"mt-1 text-xs text-muted-foreground leading-relaxed",children:te}),c&&e.jsx("div",{className:"mt-2 text-xs",children:e.jsxs(i,{variant:"outline",className:"text-xs",children:["Frecuencia: ",c.horas_intervalo," horas"]})})]}),e.jsxs("div",{className:"rounded-md border border-primary/20 bg-white/70 p-3 text-xs text-muted-foreground dark:bg-background",children:[e.jsx("p",{className:"font-semibold text-primary mb-3",children:"Estado del equipo"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-primary/5 rounded p-2.5 border border-primary/10",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide mb-1",children:"Lectura actual"}),e.jsxs("p",{className:"text-xl font-bold text-foreground",children:[se.toLocaleString(),e.jsx("span",{className:"text-sm font-normal text-muted-foreground ml-1",children:(r==null?void 0:r.tipoMantenimiento)==="Kil√≥metros"?"km":"h"})]}),A&&e.jsxs("p",{className:"text-[11px] text-muted-foreground mt-1",children:["Actualizado ",P(new Date(A.fecha),{addSuffix:!0,locale:I})]})]}),r&&e.jsxs("div",{className:`rounded p-2.5 border ${r.horasKmRestante<=0?"bg-destructive/5 border-destructive/20":r.horasKmRestante<=50?"bg-amber-50 dark:bg-amber-950/20 border-amber-200 dark:border-amber-900":"bg-emerald-50 dark:bg-emerald-950/20 border-emerald-200 dark:border-emerald-900"}`,children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide mb-1",children:r.horasKmRestante<=0?"Vencido por":"Restante"}),e.jsxs("p",{className:`text-xl font-bold ${r.horasKmRestante<=0?"text-destructive":r.horasKmRestante<=50?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[Math.abs(r.horasKmRestante).toLocaleString(),e.jsx("span",{className:"text-sm font-normal ml-1",children:r.tipoMantenimiento==="Kil√≥metros"?"km":"h"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Pr√≥ximo en: ",r.proximoMantenimiento.toLocaleString()," ",r.tipoMantenimiento==="Kil√≥metros"?"km":"h"]})]}),e.jsx("div",{className:"pt-2 border-t border-primary/10",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["√öltimo mant.: ",e.jsx("span",{className:"font-medium text-foreground",children:W.toLocaleString()||"N/A"}),W>0&&r&&e.jsx("span",{className:"ml-1",children:r.tipoMantenimiento==="Kil√≥metros"?"km":"h"})]})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-md border border-primary/20 bg-white/80 p-3 dark:bg-background",children:[e.jsxs("p",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-primary/80",children:[e.jsx(O,{className:"h-4 w-4"})," Kit sugerido"]}),ae.length>0?e.jsx("ul",{className:"mt-2 space-y-2 text-xs text-foreground max-h-40 overflow-y-auto",children:ae.map((s,l)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{variant:"outline",className:"border-primary/30 bg-primary/5 text-primary shrink-0",children:s.numero_parte||s.pieza&&s.pieza.numero_parte}),e.jsx("span",{className:"leading-snug",children:s.descripcion||s.pieza&&s.pieza.descripcion})]},s.id||l))}):e.jsxs("p",{className:"mt-2 text-xs text-muted-foreground",children:["No hay kits asociados a este intervalo. ",S?"Importa kits o as√≠gnalos manualmente.":"Crea un plan de mantenimiento para este equipo."]})]}),e.jsxs("div",{className:"rounded-md border border-primary/20 bg-white/80 p-3 dark:bg-background",children:[e.jsxs("p",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-primary/80",children:[e.jsx(Se,{className:"h-4 w-4"})," Tareas clave"]}),re.length>0?e.jsx("ul",{className:"mt-2 space-y-1 text-xs text-foreground max-h-40 overflow-y-auto",children:re.map((s,l)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-primary shrink-0"}),e.jsx("span",{className:"leading-snug",children:s})]},l))}):e.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"No hay tareas definidas para este intervalo."})]})]})]})]}),e.jsx(Be,{modelo:a.modelo,numeroSerie:a.numeroSerie,marca:a.marca,mantenimientos:m}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(M,{className:"text-lg",children:"Informaci√≥n del Equipo"})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Marca"}),e.jsx("p",{className:"font-medium",children:a.marca})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Modelo"}),e.jsx("p",{className:"font-medium",children:a.modelo})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"N√∫mero de Serie"}),e.jsx("p",{className:"font-medium",children:a.numeroSerie})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Placa"}),e.jsx("p",{className:"font-medium",children:a.placa})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Categor√≠a"}),e.jsx("p",{className:"font-medium",children:a.categoria})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Estado"}),e.jsx(i,{variant:a.activo?"default":"secondary",children:a.activo?"Activo":"Inactivo"})]}),!a.activo&&a.motivoInactividad&&e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Motivo de Inactividad"}),e.jsx("p",{className:"font-medium",children:a.motivoInactividad})]})]})]}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"Estado General"]})}),e.jsxs(b,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Mantenimientos activos"}),e.jsx(i,{children:m.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Mantenimientos vencidos"}),e.jsx(i,{variant:ne?"destructive":"default",children:m.filter(s=>s.horasKmRestante<0).length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Repuestos compatibles"}),e.jsx(i,{children:w.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Eventos registrados"}),e.jsx(i,{children:t.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"√öltimo mantenimiento realizado"}),e.jsx(i,{variant:E?"secondary":"outline",children:E?X(new Date(E.fechaMantenimiento),"dd MMM yyyy",{locale:I}):"Sin registros"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"√öltima lectura registrada"}),e.jsx(i,{variant:"outline",children:A?`${A.horasKm} ‚Ä¢ ${P(new Date(A.fecha),{addSuffix:!0,locale:I})}`:"Sin registros"})]})]})]})]}),e.jsxs(q,{value:"mantenimiento",className:"space-y-4",children:[m.length===0?e.jsx(f,{children:e.jsxs(b,{className:"p-8 text-center",children:[e.jsx(Ce,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No hay mantenimientos programados para este equipo"})]})}):m.map(s=>e.jsxs(f,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{className:"text-lg",children:s.tipoMantenimiento}),e.jsx(i,{variant:Z(s.horasKmRestante),children:Y(s.horasKmRestante,s.tipoMantenimiento==="Kil√≥metros"?"km":"horas")})]})}),e.jsxs(b,{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Horas/Km Actuales"}),e.jsx("p",{className:"font-medium",children:s.horasKmActuales})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pr√≥ximo Mantenimiento"}),e.jsx("p",{className:"font-medium",children:s.proximoMantenimiento})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Frecuencia"}),e.jsxs("p",{className:"font-medium",children:["Cada ",s.frecuencia]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"√öltima Actualizaci√≥n"}),e.jsx("p",{className:"font-medium text-xs",children:P(new Date(s.fechaUltimaActualizacion),{addSuffix:!0,locale:I})})]})]})]},s.id)),d.length>0&&e.jsxs(f,{className:"border border-amber-200/70 bg-amber-50/40",children:[e.jsx(C,{children:e.jsxs(M,{className:"flex items-center gap-2 text-amber-700",children:[e.jsx(V,{className:"h-5 w-5"}),"Mantenimientos realizados"]})}),e.jsx(b,{className:"space-y-4",children:d.map(s=>{var l;return e.jsxs("div",{className:"rounded-xl border border-amber-200/60 bg-white/70 p-4 transition-all duration-300 hover:-translate-y-0.5 hover:shadow-md",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("span",{className:"text-sm font-semibold text-amber-800",children:X(new Date(s.fechaMantenimiento),"dd MMM yyyy",{locale:I})}),e.jsxs(i,{variant:"outline",children:["Lectura: ",s.horasKmAlMomento]})]}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:s.observaciones||"Sin observaciones registradas."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:[e.jsx("span",{className:"rounded-full bg-amber-100 px-3 py-1 font-medium text-amber-700",children:s.usuarioResponsable}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3 text-amber-600"}),"Incremento: ",s.incrementoDesdeUltimo]})]}),((l=s.filtrosUtilizados)==null?void 0:l.length)>0&&e.jsxs("div",{className:"mt-3 rounded-lg border border-amber-200/60 bg-amber-50/60 p-3 text-xs",children:[e.jsx("p",{className:"font-semibold text-amber-700",children:"Insumos utilizados"}),e.jsx("ul",{className:"mt-2 grid gap-1 sm:grid-cols-2",children:s.filtrosUtilizados.map((D,H)=>e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{children:D.nombre}),e.jsx("span",{className:"font-medium text-amber-800",children:D.cantidad})]},`${s.id}-${H}`))})]})]},s.id)})})]}),j.length>0&&e.jsxs(f,{className:"border border-sky-200/70 bg-sky-50/40",children:[e.jsx(C,{children:e.jsxs(M,{className:"flex items-center gap-2 text-sky-700",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Actualizaciones de horas/km"]})}),e.jsx(b,{className:"space-y-3",children:j.map(s=>e.jsxs("div",{className:"rounded-xl border border-sky-200/60 bg-white/70 p-4 transition-all duration-300 hover:-translate-y-0.5 hover:shadow-md",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("span",{className:"text-sm font-semibold text-sky-800",children:X(new Date(s.fecha),"dd MMM yyyy",{locale:I})}),e.jsxs(i,{variant:"outline",children:[s.horasKm," horas/km"]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3 text-sky-500"}),"Incremento: ",s.incremento]}),e.jsx("span",{className:"rounded-full bg-sky-100 px-3 py-1 font-medium text-sky-700",children:s.usuarioResponsable})]}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:["Registrado ",P(new Date(s.fecha),{addSuffix:!0,locale:I})]})]},s.id))})]})]}),e.jsx(q,{value:"inventario",className:"space-y-4",children:w.length===0?e.jsx(f,{children:e.jsxs(b,{className:"p-8 text-center",children:[e.jsx(O,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No hay repuestos relacionados con este equipo"})]})}):w.map(s=>e.jsxs(f,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{className:"text-lg",children:s.nombre}),e.jsxs(i,{variant:s.cantidad===0?"destructive":s.cantidad<=5?"secondary":"default",children:["Stock: ",s.cantidad]})]})}),e.jsxs(b,{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tipo"}),e.jsx("p",{className:"font-medium",children:s.tipo})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"C√≥digo"}),e.jsx("p",{className:"font-medium",children:s.codigoIdentificacion})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Proveedor"}),e.jsx("p",{className:"font-medium",children:s.empresaSuplidora})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Categor√≠a"}),e.jsx("p",{className:"font-medium",children:s.categoriaEquipo})]})]})]},s.id))}),e.jsx(q,{value:"historial",className:"space-y-4",children:t.length===0?e.jsx(f,{children:e.jsxs(b,{className:"p-8 text-center",children:[e.jsx(V,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No hay eventos registrados para este equipo"})]})}):t.map(s=>e.jsx(f,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10 mt-1",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{children:s.etiquetaSubtipo??s.etiquetaCategoria}),e.jsx(i,{variant:"outline",children:s.modulo})]}),e.jsx("p",{className:"font-medium mb-1",children:s.descripcion}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[P(new Date(s.createdAt),{addSuffix:!0,locale:I})," ‚Ä¢ ",s.usuarioResponsable]})]})]})})},s.id))})]})]})})}export{ls as E};
