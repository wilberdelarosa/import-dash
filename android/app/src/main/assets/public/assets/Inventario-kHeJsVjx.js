import{c as fe,r as d,j as e,a as x,b as Ee}from"./index-C_D-5Bfv.js";import{u as Pe,a as Te,r as qe,b as Re,c as Le,d as Be,e as He,P as w,B as N,T as R,t as ve,s as Ne,L as Z,D as W,o as Y,p as _,q as ee,F as ae,G as se,I as te,J as re,K as le,M as ie,N as oe,O as ne,Q as ce,U as de,g as E,h as P,l as T,k as q,j as ze}from"./card-BIr-PJK2.js";import{T as Oe,a as Ue,b as me,c as C,d as Ve,e as k}from"./table-CQA1OK80.js";import{I as i}from"./input-DSUZcGci.js";import{B as m}from"./index-BtotK06U.js";import{T as xe}from"./textarea-BSj91dWz.js";import{S as $e}from"./switch-B03PpzBD.js";import{S as ue,a as he,b as pe,c as ge,d as M}from"./select-3Jn5ARjr.js";import{u as Ge}from"./useDeviceDetection-CShWnkOv.js";import{M as Ke}from"./MobileLayout-CV04gzFk.js";import{M as Xe}from"./MobileCard-DMSzGukU.js";import{D as Je,a as Qe,E as Ze,b as We,c as $}from"./dropdown-menu-DmUKo3Zs.js";import{L as Ye}from"./list-filter-CnSSRe_v.js";import{P as we}from"./pencil-CnmjDfEJ.js";import{L as _e}from"./lock-Dz87eZuj.js";import{P as ye}from"./plus-Cjn5SSed.js";import{F as ea}from"./filter-ldW4984T.js";import"./chevron-right-fj5H7AOZ.js";import"./sparkles-CBL8q4dG.js";import"./index-APdQY6Km.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=fe("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=fe("PackageX",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]]);function aa({inventarios:n,onAdd:S,onEdit:z,onDelete:O}){const[l,h]=d.useState("all"),[p,F]=d.useState(""),[U,b]=d.useState(!1),{currentUserRole:V}=Pe(),I=V==="admin",o=d.useMemo(()=>{const s=n.length,r=n.filter(u=>u.tipo==="Filtro").length,f=n.filter(u=>u.tipo==="Aceite").length,y=n.filter(u=>u.tipo==="Repuesto").length,c=n.filter(u=>u.tipo==="Herramienta").length,v=n.filter(u=>u.cantidad<u.stockMinimo).length;return{total:s,filtros:r,aceites:f,repuestos:y,herramientas:c,lowStock:v}},[n]),g=d.useMemo(()=>{let s=n;if(l==="low-stock"?s=s.filter(r=>r.cantidad<r.stockMinimo):l!=="all"&&(s=s.filter(r=>r.tipo===l)),p.trim()){const r=p.toLowerCase();s=s.filter(f=>{var y,c,v;return((y=f.nombre)==null?void 0:y.toLowerCase().includes(r))||((c=f.numeroParte)==null?void 0:c.toLowerCase().includes(r))||((v=f.codigoIdentificacion)==null?void 0:v.toLowerCase().includes(r))})}return s},[n,l,p]),j=s=>s.cantidad<s.stockMinimo;return e.jsxs(Ke,{title:"Inventario",headerActions:e.jsxs(Te,{open:U,onOpenChange:b,children:[e.jsx(qe,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-full hover:bg-primary/10 active:scale-95 transition-all",children:e.jsx(Ye,{className:"h-5 w-5"})})}),e.jsxs(Re,{side:"bottom",className:"h-[550px] rounded-t-[2rem] border-t-0 bg-background/95 backdrop-blur-xl",children:[e.jsx("div",{className:"mx-auto mt-2 h-1 w-12 rounded-full bg-muted"}),e.jsxs(Le,{className:"mt-4",children:[e.jsx(Be,{className:"text-center text-xl font-bold",children:"Filtrar inventario"}),e.jsx(He,{className:"text-center",children:"Muestra por tipo o estado de stock"})]}),e.jsxs("div",{className:"mt-8 space-y-3 px-4",children:[e.jsxs(m,{variant:l==="all"?"default":"outline",className:x("w-full justify-start gap-3 h-14 text-base rounded-xl transition-all",l==="all"&&"bg-primary shadow-lg shadow-primary/25"),onClick:()=>{h("all"),b(!1)},children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-background/20",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex flex-1 items-center justify-between",children:[e.jsx("span",{children:"Todos los items"}),e.jsx(N,{variant:"secondary",className:"bg-background/20 text-foreground",children:o.total})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(m,{variant:l==="Filtro"?"default":"outline",className:x("w-full justify-start gap-2 h-12 rounded-xl",l==="Filtro"&&"bg-blue-600 hover:bg-blue-700 border-blue-600"),onClick:()=>{h("Filtro"),b(!1)},children:[e.jsx(Ce,{className:"h-4 w-4"}),"Filtros (",o.filtros,")"]}),e.jsxs(m,{variant:l==="Aceite"?"default":"outline",className:x("w-full justify-start gap-2 h-12 rounded-xl",l==="Aceite"&&"bg-amber-600 hover:bg-amber-700 border-amber-600"),onClick:()=>{h("Aceite"),b(!1)},children:[e.jsx(w,{className:"h-4 w-4"}),"Aceites (",o.aceites,")"]}),e.jsxs(m,{variant:l==="Repuesto"?"default":"outline",className:x("w-full justify-start gap-2 h-12 rounded-xl",l==="Repuesto"&&"bg-slate-600 hover:bg-slate-700 border-slate-600"),onClick:()=>{h("Repuesto"),b(!1)},children:[e.jsx(w,{className:"h-4 w-4"}),"Repuestos (",o.repuestos,")"]}),e.jsxs(m,{variant:l==="Herramienta"?"default":"outline",className:x("w-full justify-start gap-2 h-12 rounded-xl",l==="Herramienta"&&"bg-purple-600 hover:bg-purple-700 border-purple-600"),onClick:()=>{h("Herramienta"),b(!1)},children:[e.jsx(w,{className:"h-4 w-4"}),"Herram. (",o.herramientas,")"]})]}),e.jsxs(m,{variant:l==="low-stock"?"destructive":"outline",className:x("w-full justify-start gap-3 h-14 mt-2 rounded-xl border-red-200 dark:border-red-900",l==="low-stock"&&"shadow-lg shadow-red-900/20"),onClick:()=>{h("low-stock"),b(!1)},children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex flex-1 items-center justify-between",children:[e.jsx("span",{className:x(l!=="low-stock"&&"text-red-600 dark:text-red-400"),children:"Stock Bajo"}),e.jsx(N,{variant:l==="low-stock"?"secondary":"destructive",className:x(l==="low-stock"&&"bg-background/20 text-foreground"),children:o.lowStock})]})]})]})]})]}),children:[e.jsxs("div",{className:"space-y-6 pb-24",children:[o.lowStock>0&&l!=="low-stock"&&e.jsxs("div",{className:"group relative flex items-center gap-3 rounded-2xl border border-red-500/20 bg-red-500/5 p-4 cursor-pointer overflow-hidden transition-all hover:bg-red-500/10 active:scale-[0.98]",onClick:()=>h("low-stock"),children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5 bg-red-500"}),e.jsx("div",{className:"relative flex h-12 w-12 items-center justify-center rounded-full bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400 shadow-sm",children:e.jsx(R,{className:"h-6 w-6 animate-pulse-soft"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:"Atención Requerida"}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate mt-0.5",children:[o.lowStock," ",o.lowStock===1?"item tiene":"items tienen"," stock crítico"]})]}),e.jsx("div",{className:"flex items-center justify-center h-8 w-8 rounded-full bg-red-500 text-white font-bold text-xs shadow-md animate-pulse",children:o.lowStock})]}),e.jsxs("div",{className:"sticky top-0 z-20 -mx-4 px-4 py-2 bg-background/80 backdrop-blur-xl border-b border-border/50 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(i,{placeholder:"Buscar item...",value:p,onChange:s=>F(s.target.value),className:"pl-9 bg-muted/50 border-0 focus-visible:ring-1 focus-visible:ring-primary/50 h-10 rounded-xl"})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 no-scrollbar",children:[e.jsx(N,{variant:l==="all"?"default":"outline",className:x("cursor-pointer px-4 py-1.5 rounded-full transition-all duration-300 whitespace-nowrap",l==="all"?"bg-primary shadow-lg shadow-primary/25 border-0":"hover:bg-accent"),onClick:()=>h("all"),children:"Todos"}),e.jsx(N,{variant:l==="Filtro"?"default":"outline",className:x("cursor-pointer px-4 py-1.5 rounded-full transition-all duration-300 whitespace-nowrap",l==="Filtro"?"bg-blue-600 border-0 shadow-lg shadow-blue-900/20":"hover:bg-accent"),onClick:()=>h("Filtro"),children:"Filtros"}),e.jsx(N,{variant:l==="Aceite"?"default":"outline",className:x("cursor-pointer px-4 py-1.5 rounded-full transition-all duration-300 whitespace-nowrap",l==="Aceite"?"bg-amber-600 border-0 shadow-lg shadow-amber-900/20":"hover:bg-accent"),onClick:()=>h("Aceite"),children:"Aceites"}),e.jsx(N,{variant:l==="Repuesto"?"default":"outline",className:x("cursor-pointer px-4 py-1.5 rounded-full transition-all duration-300 whitespace-nowrap",l==="Repuesto"?"bg-slate-600 border-0 shadow-lg shadow-slate-900/20":"hover:bg-accent"),onClick:()=>h("Repuesto"),children:"Repuestos"})]})]}),g.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-3",children:g.map((s,r)=>e.jsxs(Xe,{variant:"compact",className:x("relative animate-in slide-in-from-bottom-4 fade-in fill-mode-backwards group overflow-visible",j(s)?"border-red-500/30 bg-red-500/5":"bg-card/50 backdrop-blur-sm border-border/50"),style:{animationDelay:`${r*.05}s`},children:[e.jsxs(Je,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity focus:opacity-100 data-[state=open]:opacity-100",children:e.jsx(Ze,{className:"h-4 w-4"})})}),e.jsx(We,{align:"end",className:"w-40 rounded-xl",children:I?e.jsxs(e.Fragment,{children:[e.jsxs($,{onClick:()=>z(s),className:"gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Editar"]}),e.jsxs($,{onClick:()=>O(s),className:"text-destructive focus:text-destructive focus:bg-destructive/10 gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Eliminar"]})]}):e.jsxs($,{disabled:!0,className:"gap-2 text-muted-foreground",children:[e.jsx(_e,{className:"h-4 w-4"}),"Solo lectura"]})})]}),e.jsxs("div",{className:"space-y-3 pt-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsx("p",{className:"text-xs font-bold line-clamp-2 leading-tight text-foreground/90 h-8",children:s.nombre})}),e.jsx("p",{className:"text-[0.65rem] text-muted-foreground font-mono bg-muted/50 rounded px-1 w-fit",children:s.numeroParte||"N/A"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(N,{variant:s.activo?"outline":"secondary",className:"text-[0.6rem] px-1.5 py-0 h-4 border-primary/20 text-primary",children:s.tipo})}),e.jsxs("div",{className:"space-y-1.5 bg-accent/5 rounded-lg p-2 border border-border/30",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-[0.65rem] text-muted-foreground",children:"Stock:"}),e.jsx("span",{className:x("text-sm font-bold",j(s)?"text-red-600":"text-foreground"),children:s.cantidad})]}),e.jsx("div",{className:"w-full bg-secondary h-1 rounded-full overflow-hidden",children:e.jsx("div",{className:x("h-full rounded-full transition-all duration-500",j(s)?"bg-red-500":"bg-primary"),style:{width:`${Math.min(s.cantidad/(s.stockMinimo*2)*100,100)}%`}})})]}),j(s)&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600 animate-pulse",children:[e.jsx(R,{className:"h-3 w-3"}),e.jsx("span",{className:"text-[0.65rem] font-bold",children:"Stock Crítico"})]})]})]},s.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center animate-in fade-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-muted/50 flex items-center justify-center mb-4",children:e.jsx(w,{className:"h-10 w-10 text-muted-foreground/50"})}),e.jsx("h3",{className:"text-lg font-semibold text-muted-foreground",children:"No hay items"}),e.jsx("p",{className:"text-sm text-muted-foreground/70 mt-1 max-w-[200px]",children:p||l!=="all"?"Intenta con otros filtros":"Agrega tu primer item al inventario"}),p&&e.jsx(m,{variant:"link",onClick:()=>F(""),className:"mt-2",children:"Limpiar búsqueda"})]})]}),I&&e.jsx(m,{size:"lg",className:"fixed bottom-24 right-4 h-14 w-14 rounded-full shadow-lg shadow-primary/30 bg-primary hover:bg-primary/90 hover:scale-105 active:scale-95 transition-all duration-300 z-50",onClick:S,children:e.jsx(ye,{className:"h-7 w-7 text-primary-foreground"})})]})}const B=()=>({nombre:"",numeroParte:"",tipo:"",sistema:"",categoriaEquipo:"",cantidad:"",stockMinimo:"",codigoIdentificacion:"",empresaSuplidora:"",marcaFabricante:"",marcasCompatibles:"",modelosCompatibles:"",ubicacion:"",activo:!0}),je=n=>n.split(/[\n,]/).map(S=>S.trim()).filter(Boolean),H=n=>n.join(", ");function wa(){const{isMobile:n}=Ge(),{data:S,loading:z,createInventario:O,updateInventario:l,deleteInventario:h}=Ee(),p=d.useMemo(()=>S.inventarios??[],[S.inventarios]),[F,U]=d.useState(""),[b,V]=d.useState("all"),[I,o]=d.useState(!1),[g,j]=d.useState(null),[s,r]=d.useState(B()),[f,y]=d.useState(!1),[c,v]=d.useState(null),[u,G]=d.useState(!1),ke=d.useMemo(()=>Array.from(new Set(p.map(a=>a.tipo))).sort(),[p]),D=d.useMemo(()=>{const a=F.trim().toLowerCase();return p.filter(t=>b==="all"||t.tipo===b?a?[t.nombre,t.numeroParte,t.codigoIdentificacion,t.marcaFabricante??"",t.empresaSuplidora??"",t.marcasCompatibles.join(" "),t.modelosCompatibles.join(" "),t.categoriaEquipo,t.sistema??""].join(" ").toLowerCase().includes(a):!0:!1)},[p,F,b]),Se=D.length,Fe=D.filter(a=>a.cantidad<=Math.max(a.stockMinimo,0)).length,Me=D.filter(a=>a.cantidad===0).length,Ie=()=>{j(null),r(B()),o(!0)},De=a=>{j(a),r({nombre:a.nombre,numeroParte:a.numeroParte,tipo:a.tipo,sistema:a.sistema??"",categoriaEquipo:a.categoriaEquipo,cantidad:String(a.cantidad),stockMinimo:String(a.stockMinimo),codigoIdentificacion:a.codigoIdentificacion,empresaSuplidora:a.empresaSuplidora??"",marcaFabricante:a.marcaFabricante??"",marcasCompatibles:H(a.marcasCompatibles),modelosCompatibles:H(a.modelosCompatibles),ubicacion:a.ubicacion??"",activo:a.activo}),o(!0)},K=()=>{r(B()),j(null)},Ae=()=>{const a=je(s.marcasCompatibles),t=je(s.modelosCompatibles),L=Number(s.cantidad)||0,A=Number(s.stockMinimo)||0;return{nombre:s.nombre.trim(),numeroParte:s.numeroParte.trim()||s.codigoIdentificacion.trim(),tipo:s.tipo.trim()||"Consumible",sistema:s.sistema.trim()||null,categoriaEquipo:s.categoriaEquipo.trim()||"General",cantidad:L,stockMinimo:A,movimientos:(g==null?void 0:g.movimientos)??[],activo:s.activo,codigoIdentificacion:s.codigoIdentificacion.trim(),ubicacion:s.ubicacion.trim()||null,empresaSuplidora:s.empresaSuplidora.trim(),marcaFabricante:s.marcaFabricante.trim()||null,marcasCompatibles:a,modelosCompatibles:t}},X=async a=>{if(a.preventDefault(),!(!s.nombre.trim()||!s.codigoIdentificacion.trim()))try{y(!0);const t=Ae();g?await l(g.id,t):await O(t),o(!1),K()}catch{}finally{y(!1)}},J=async()=>{if(c)try{G(!0),await h(c.id),v(null)}catch{}finally{G(!1)}};if(z)return n?e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-base text-muted-foreground",children:"Cargando inventario..."})}):e.jsx(Z,{title:"Inventario de Repuestos",children:e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"text-lg text-muted-foreground",children:"Cargando inventario..."})})});const Q=!!s.nombre.trim()&&!!s.codigoIdentificacion.trim();return n?e.jsxs(e.Fragment,{children:[e.jsx(aa,{inventarios:p,onAdd:()=>{j(null),r(B()),o(!0)},onEdit:a=>{j(a),r({nombre:a.nombre??"",numeroParte:a.numeroParte??"",tipo:a.tipo??"",sistema:a.sistema??"",categoriaEquipo:a.categoriaEquipo??"",cantidad:String(a.cantidad??0),stockMinimo:String(a.stockMinimo??0),codigoIdentificacion:a.codigoIdentificacion??"",empresaSuplidora:a.empresaSuplidora??"",marcaFabricante:a.marcaFabricante??"",marcasCompatibles:H(a.marcasCompatibles??[]),modelosCompatibles:H(a.modelosCompatibles??[]),ubicacion:a.ubicacion??"",activo:a.activo??!0}),o(!0)},onDelete:a=>v(a)}),e.jsx(W,{open:I,onOpenChange:o,children:e.jsxs(Y,{className:"max-h-[85vh] overflow-y-auto",children:[e.jsxs(_,{children:[e.jsx(ee,{children:g?"Editar Item":"Agregar Item"}),e.jsx(ae,{children:g?"Modifica la información del item":"Completa los datos del nuevo item"})]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),X(a)},className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"nombre",className:"text-sm font-medium",children:"Nombre *"}),e.jsx(i,{id:"nombre",value:s.nombre,onChange:a=>r({...s,nombre:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"codigoIdentificacion",className:"text-sm font-medium",children:"Código de Identificación *"}),e.jsx(i,{id:"codigoIdentificacion",value:s.codigoIdentificacion,onChange:a=>r({...s,codigoIdentificacion:a.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"numeroParte",className:"text-sm font-medium",children:"Número de Parte"}),e.jsx(i,{id:"numeroParte",value:s.numeroParte,onChange:a=>r({...s,numeroParte:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"tipo",className:"text-sm font-medium",children:"Tipo"}),e.jsxs(ue,{value:s.tipo,onValueChange:a=>r({...s,tipo:a}),children:[e.jsx(he,{id:"tipo",children:e.jsx(pe,{placeholder:"Seleccionar"})}),e.jsxs(ge,{children:[e.jsx(M,{value:"Filtro",children:"Filtro"}),e.jsx(M,{value:"Aceite",children:"Aceite"}),e.jsx(M,{value:"Repuesto",children:"Repuesto"}),e.jsx(M,{value:"Herramienta",children:"Herramienta"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"cantidad",className:"text-sm font-medium",children:"Cantidad"}),e.jsx(i,{id:"cantidad",type:"number",min:"0",value:s.cantidad,onChange:a=>r({...s,cantidad:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"stockMinimo",className:"text-sm font-medium",children:"Stock Mínimo"}),e.jsx(i,{id:"stockMinimo",type:"number",min:"0",value:s.stockMinimo,onChange:a=>r({...s,stockMinimo:a.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"empresaSuplidora",className:"text-sm font-medium",children:"Empresa Suplidora"}),e.jsx(i,{id:"empresaSuplidora",value:s.empresaSuplidora,onChange:a=>r({...s,empresaSuplidora:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"ubicacion",className:"text-sm font-medium",children:"Ubicación"}),e.jsx(i,{id:"ubicacion",value:s.ubicacion,onChange:a=>r({...s,ubicacion:a.target.value})})]}),e.jsx(se,{children:e.jsx(m,{type:"submit",disabled:f||!Q,children:f?"Guardando...":g?"Actualizar":"Crear"})})]})]})}),e.jsx(te,{open:!!c,onOpenChange:()=>v(null),children:e.jsxs(re,{children:[e.jsxs(le,{children:[e.jsx(ie,{children:"Confirmar eliminación"}),e.jsxs(oe,{children:['¿Eliminar "',c==null?void 0:c.nombre,'"? Esta acción no se puede deshacer.']})]}),e.jsxs(ne,{children:[e.jsx(ce,{children:"Cancelar"}),e.jsx(de,{onClick:()=>{c&&J()},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar"})]})]})})]}):e.jsxs(Z,{title:"Inventario de Repuestos",children:[e.jsxs("div",{className:"space-y-6 lg:space-y-8",children:[e.jsxs("section",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(E,{className:"group relative overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-xl border-l-4 border-l-primary",children:[e.jsx("div",{className:"absolute right-0 top-0 h-full w-24 bg-primary/5 transform skew-x-12 translate-x-8"}),e.jsxs(P,{className:"relative pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"Total Items"}),e.jsx("div",{className:"rounded-full bg-primary/10 p-2 transition-transform group-hover:scale-110",children:e.jsx(w,{className:"h-5 w-5 text-primary"})})]}),e.jsx(q,{className:"text-4xl font-bold tracking-tight text-primary",children:Se}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Piezas en catálogo"})]})]}),e.jsxs(E,{className:"group relative overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-xl border-l-4 border-l-amber-500",children:[e.jsx("div",{className:"absolute right-0 top-0 h-full w-24 bg-amber-500/5 transform skew-x-12 translate-x-8"}),e.jsxs(P,{className:"relative pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"Stock ≤ umbral"}),e.jsx("div",{className:"rounded-full bg-amber-500/10 p-2 transition-transform group-hover:scale-110",children:e.jsx(R,{className:"h-5 w-5 text-amber-600"})})]}),e.jsx(q,{className:"text-4xl font-bold tracking-tight text-amber-600",children:Fe}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requieren atención"})]})]}),e.jsxs(E,{className:"group relative overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-xl border-l-4 border-l-destructive",children:[e.jsx("div",{className:"absolute right-0 top-0 h-full w-24 bg-destructive/5 transform skew-x-12 translate-x-8"}),e.jsxs(P,{className:"relative pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"Sin stock"}),e.jsx("div",{className:"rounded-full bg-destructive/10 p-2 transition-transform group-hover:scale-110",children:e.jsx(be,{className:"h-5 w-5 text-destructive"})})]}),e.jsx(q,{className:"text-4xl font-bold tracking-tight text-destructive",children:Me}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Necesitan reabastecimiento"})]})]}),e.jsxs(E,{className:"group relative overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-xl border-l-4 border-l-emerald-500",children:[e.jsx("div",{className:"absolute right-0 top-0 h-full w-24 bg-emerald-500/5 transform skew-x-12 translate-x-8"}),e.jsxs(P,{className:"relative pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"Modelos cubiertos"}),e.jsx("div",{className:"rounded-full bg-emerald-500/10 p-2 transition-transform group-hover:scale-110",children:e.jsx(Ce,{className:"h-5 w-5 text-emerald-600"})})]}),e.jsx(q,{className:"text-4xl font-bold tracking-tight text-emerald-600",children:new Set(p.flatMap(a=>a.modelosCompatibles)).size}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Equipos compatibles"})]})]})]}),e.jsxs(E,{className:"overflow-hidden shadow-lg border-t-4 border-t-primary/30",children:[e.jsxs(P,{className:"space-y-4 bg-gradient-to-r from-primary/5 via-transparent to-transparent",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(q,{className:"flex items-center gap-2.5 text-xl font-bold tracking-tight",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2",children:e.jsx(w,{className:"h-5 w-5 text-primary"})}),"Inventario de repuestos y filtros"]}),e.jsx(T,{className:"text-sm",children:"Gestiona números de parte, compatibilidades y existencias para cada equipo"})]}),e.jsxs(m,{onClick:Ie,className:"shadow-md hover:shadow-lg transition-all duration-300",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Nuevo item"]})]}),e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ve,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(i,{placeholder:"Buscar por nombre, codigo o modelo compatible...",value:F,onChange:a=>U(a.target.value),className:"pl-10"})]}),e.jsxs(ue,{value:b,onValueChange:V,children:[e.jsxs(he,{className:"w-full lg:w-[220px]",children:[e.jsx(ea,{className:"mr-2 h-4 w-4"}),e.jsx(pe,{placeholder:"Tipo"})]}),e.jsxs(ge,{children:[e.jsx(M,{value:"all",children:"Todos los tipos"}),ke.map(a=>e.jsx(M,{value:a,children:a},a))]})]})]})]}),e.jsxs(ze,{className:"px-0 pb-6 sm:px-6",children:[e.jsx("div",{className:"-mx-4 overflow-x-auto sm:mx-0",children:e.jsx("div",{className:"min-w-full rounded-md border",children:e.jsxs(Oe,{className:"w-full min-w-[1000px]",children:[e.jsx(Ue,{children:e.jsxs(me,{children:[e.jsx(C,{children:"Identificador"}),e.jsx(C,{children:"Nombre / Marca"}),e.jsx(C,{children:"Categoria / Sistema"}),e.jsx(C,{children:"Compatibilidad"}),e.jsx(C,{children:"Stock"}),e.jsx(C,{className:"min-w-[160px]",children:"Ubicacion y estado"}),e.jsx(C,{className:"text-right",children:"Acciones"})]})}),e.jsx(Ve,{children:D.map(a=>{const t=a.cantidad===0,L=!t&&a.cantidad<=a.stockMinimo;return e.jsxs(me,{className:"group hover:bg-muted/50 transition-colors duration-200",children:[e.jsxs(k,{children:[e.jsx("div",{className:"font-semibold",children:a.codigoIdentificacion}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.numeroParte})]}),e.jsxs(k,{children:[e.jsx("div",{className:"font-medium",children:a.nombre}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.marcaFabricante||"Sin marca"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-sm",children:a.categoriaEquipo}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.sistema||"Sistema general"})]}),e.jsxs(k,{children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.marcasCompatibles.slice(0,2).map(A=>e.jsx(N,{variant:"outline",className:"text-xs",children:A},A)),a.marcasCompatibles.length>2&&e.jsxs(N,{variant:"outline",className:"text-xs",children:["+",a.marcasCompatibles.length-2]})]}),a.modelosCompatibles.length>0?e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:[a.modelosCompatibles.slice(0,3).join(", "),a.modelosCompatibles.length>3&&` +${a.modelosCompatibles.length-3}`]}):e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Sin modelos definidos"})]}),e.jsx(k,{children:t?e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-destructive/10 px-3 py-1.5 border border-destructive/20",children:[e.jsx(be,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"font-bold text-destructive",children:a.cantidad}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",a.stockMinimo]})]}):L?e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-amber-500/10 px-3 py-1.5 border border-amber-500/20",children:[e.jsx(R,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"font-bold text-amber-600",children:a.cantidad}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",a.stockMinimo]})]}):e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-emerald-500/10 px-3 py-1.5 border border-emerald-500/20",children:[e.jsx(w,{className:"h-4 w-4 text-emerald-600"}),e.jsx("span",{className:"font-bold text-emerald-600",children:a.cantidad}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",a.stockMinimo]})]})}),e.jsx(k,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(N,{variant:a.activo?"default":"secondary",children:a.activo?"Activo":"Inactivo"}),a.ubicacion&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Ubicacion: ",a.ubicacion]}),a.empresaSuplidora&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Proveedor: ",a.empresaSuplidora]})]})}),e.jsx(k,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>De(a),"aria-label":`Editar ${a.nombre}`,title:`Editar ${a.nombre}`,className:"hover:bg-primary/10 hover:text-primary",children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>v(a),"aria-label":`Eliminar ${a.nombre}`,title:`Eliminar ${a.nombre}`,className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(Ne,{className:"h-4 w-4"})})]})})]},a.id)})})]})})}),D.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"No se encontraron items que coincidan con la busqueda."})]})]})]}),e.jsx(W,{open:I,onOpenChange:a=>{o(a),a||K()},children:e.jsxs(Y,{className:"max-w-3xl",children:[e.jsxs(_,{children:[e.jsx(ee,{children:g?"Editar item":"Registrar repuesto"}),e.jsx(ae,{children:"Define los datos del inventario, compatibilidades y umbrales de abastecimiento."})]}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:X,children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nombre",className:"text-sm font-medium",children:"Nombre *"}),e.jsx(i,{id:"nombre",value:s.nombre,onChange:a=>r(t=>({...t,nombre:a.target.value})),placeholder:"Filtro de aceite motor"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"codigo",className:"text-sm font-medium",children:"Codigo interno *"}),e.jsx(i,{id:"codigo",value:s.codigoIdentificacion,onChange:a=>r(t=>({...t,codigoIdentificacion:a.target.value})),placeholder:"FLT-320-PM2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"numeroParte",className:"text-sm font-medium",children:"Numero de parte fabricante"}),e.jsx(i,{id:"numeroParte",value:s.numeroParte,onChange:a=>r(t=>({...t,numeroParte:a.target.value})),placeholder:"322-3155"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tipo",className:"text-sm font-medium",children:"Tipo"}),e.jsx(i,{id:"tipo",value:s.tipo,onChange:a=>r(t=>({...t,tipo:a.target.value})),placeholder:"Filtro / Aceite / Lubricante"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"categoria",className:"text-sm font-medium",children:"Categoria del equipo"}),e.jsx(i,{id:"categoria",value:s.categoriaEquipo,onChange:a=>r(t=>({...t,categoriaEquipo:a.target.value})),placeholder:"Excavadora, Cargador..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sistema",className:"text-sm font-medium",children:"Sistema"}),e.jsx(i,{id:"sistema",value:s.sistema,onChange:a=>r(t=>({...t,sistema:a.target.value})),placeholder:"Motor, Hidraulico, Combustible..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cantidad",className:"text-sm font-medium",children:"Stock disponible"}),e.jsx(i,{id:"cantidad",type:"number",min:"0",value:s.cantidad,onChange:a=>r(t=>({...t,cantidad:a.target.value})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stockMinimo",className:"text-sm font-medium",children:"Stock minimo"}),e.jsx(i,{id:"stockMinimo",type:"number",min:"0",value:s.stockMinimo,onChange:a=>r(t=>({...t,stockMinimo:a.target.value})),placeholder:"2"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"marcas",className:"text-sm font-medium",children:"Marcas compatibles"}),e.jsx(xe,{id:"marcas",value:s.marcasCompatibles,onChange:a=>r(t=>({...t,marcasCompatibles:a.target.value})),placeholder:"Caterpillar, Komatsu..."}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Separar por coma o salto de linea."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"modelos",className:"text-sm font-medium",children:"Modelos / fichas compatibles"}),e.jsx(xe,{id:"modelos",value:s.modelosCompatibles,onChange:a=>r(t=>({...t,modelosCompatibles:a.target.value})),placeholder:"216B3, 320-07..."}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Usa el nombre comercial que usara el equipo de mantenimiento."})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ubicacion",className:"text-sm font-medium",children:"Ubicacion en almacen"}),e.jsx(i,{id:"ubicacion",value:s.ubicacion,onChange:a=>r(t=>({...t,ubicacion:a.target.value})),placeholder:"Pasillo A / Rack 01"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"proveedor",className:"text-sm font-medium",children:"Proveedor"}),e.jsx(i,{id:"proveedor",value:s.empresaSuplidora,onChange:a=>r(t=>({...t,empresaSuplidora:a.target.value})),placeholder:"Dealer Caterpillar"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"marcaFabricante",className:"text-sm font-medium",children:"Marca fabricante"}),e.jsx(i,{id:"marcaFabricante",value:s.marcaFabricante,onChange:a=>r(t=>({...t,marcaFabricante:a.target.value})),placeholder:"Cat, Donaldson..."})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-md border p-3",children:[e.jsx($e,{checked:s.activo,onCheckedChange:a=>r(t=>({...t,activo:a}))}),e.jsxs("div",{className:"space-y-0.5 text-sm",children:[e.jsx("p",{className:"font-medium",children:"Disponible para usar"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Desactiva el item si se encuentra descontinuado o fuera de catalogo."})]})]})]}),e.jsxs(se,{children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancelar"}),e.jsx(m,{type:"submit",disabled:!Q||f,children:f?"Guardando...":g?"Actualizar":"Registrar"})]})]})]})}),e.jsx(te,{open:!!c,onOpenChange:a=>{a||v(null)},children:e.jsxs(re,{children:[e.jsxs(le,{children:[e.jsx(ie,{children:"¿Eliminar item del inventario?"}),e.jsxs(oe,{children:["Esta accion no se puede deshacer y se eliminara el registro de ",c==null?void 0:c.nombre,"."]})]}),e.jsxs(ne,{children:[e.jsx(ce,{disabled:u,children:"Cancelar"}),e.jsx(de,{onClick:J,disabled:u,children:u?"Eliminando...":"Eliminar"})]})]})})]})}export{wa as default};
