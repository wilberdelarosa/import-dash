import{c as Ue,g as Qs,h as Zs,r as l,i as bs,k as ea,j as e,u as ta,b as sa,l as aa,m as Te,a as Qe,X as os}from"./index-C_D-5Bfv.js";import{D as ra,n as na,B as E,t as wt,o as ia,p as oa,q as la,w as ca,g as ye,x as da,f as ma,L as Nt,T as Ze,W as ls,y as cs,S as ds,h as et,k as tt,j as Ee,C as ua,z as ms,l as ha,A as pa}from"./card-BIr-PJK2.js";import{S as Oe,a as Ae,b as Fe,c as Le,d as V}from"./select-3Jn5ARjr.js";import{I}from"./input-DSUZcGci.js";import{L as P}from"./label-CqFCS6R-.js";import{T as st}from"./textarea-BSj91dWz.js";import{B as z}from"./index-BtotK06U.js";import{A as _e,a as at,b as rt}from"./alert-O3FLJu-w.js";import{T as Ie,a as ze,b as se,c as D,d as $e,e as R}from"./table-CQA1OK80.js";import{T as us,a as hs,b as nt,c as it}from"./tabs-KnLULWOS.js";import{C as xa,a as fa,b as ga}from"./collapsible-DEUr-TdY.js";import{C as ps}from"./checkbox-BKYUVAI4.js";import{u as ja}from"./useCaterpillarData-DbqCupgf.js";import{g as Na}from"./caterpillarMaintenance-Dg_xV4Xi.js";import{g as be}from"./maintenanceUtils-fNWGA9SH.js";import{u as va}from"./useDeviceDetection-CShWnkOv.js";import{C as ba}from"./chevron-right-fj5H7AOZ.js";import{G as ya,M as xs}from"./map-pinned-C15isc_R.js";import"./index-APdQY6Km.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Ue("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=Ue("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Ue("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Ue("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=Ue("HardHat",[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]]);var lt={exports:{}},ys={},Ss={exports:{}},Ca="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Da=Ca,Ra=Da;function ws(){}function Cs(){}Cs.resetWarningCache=ws;var Ma=function(){function t(o,i,m,h,u,d){if(d!==Ra){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}t.isRequired=t;function a(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:a,element:t,elementType:t,instanceOf:a,node:t,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:Cs,resetWarningCache:ws};return r.PropTypes=r,r};Ss.exports=Ma();var Ds=Ss.exports;const Pa=Qs(Zs);var M={},ae={};Object.defineProperty(ae,"__esModule",{value:!0});ae.dontSetMe=Aa;ae.findInArray=ka;ae.int=Oa;ae.isFunction=Ta;ae.isNum=Ea;function ka(t,a){for(let r=0,o=t.length;r<o;r++)if(a.apply(a,[t[r],r,t]))return t[r]}function Ta(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Ea(t){return typeof t=="number"&&!isNaN(t)}function Oa(t){return parseInt(t,10)}function Aa(t,a,r){if(t[a])return new Error(`Invalid prop ${a} passed to ${r} - do not set this, set it on the child.`)}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.browserPrefixToKey=Ms;xe.browserPrefixToStyle=Fa;xe.default=void 0;xe.getPrefix=Rs;const bt=["Moz","Webkit","O","ms"];function Rs(){var r,o;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const a=(o=(r=window.document)==null?void 0:r.documentElement)==null?void 0:o.style;if(!a||t in a)return"";for(let i=0;i<bt.length;i++)if(Ms(t,bt[i])in a)return bt[i];return""}function Ms(t,a){return a?`${a}${La(t)}`:t}function Fa(t,a){return a?`-${a.toLowerCase()}-${t}`:t}function La(t){let a="",r=!0;for(let o=0;o<t.length;o++)r?(a+=t[o].toUpperCase(),r=!1):t[o]==="-"?r=!0:a+=t[o];return a}xe.default=Rs();Object.defineProperty(M,"__esModule",{value:!0});M.addClassName=Ts;M.addEvent=Ia;M.addUserSelectStyles=Va;M.createCSSTransform=Xa;M.createSVGTransform=Ya;M.getTouch=Wa;M.getTouchIdentifier=Ba;M.getTranslation=Ct;M.innerHeight=Ha;M.innerWidth=Ua;M.matchesSelector=ks;M.matchesSelectorAndParentsTo=_a;M.offsetXYFromParent=Ka;M.outerHeight=$a;M.outerWidth=qa;M.removeClassName=Es;M.removeEvent=za;M.scheduleRemoveUserSelectStyles=Ga;var J=ae,js=Ps(xe);function Ps(t,a){if(typeof WeakMap=="function")var r=new WeakMap,o=new WeakMap;return(Ps=function(i,m){if(!m&&i&&i.__esModule)return i;var h,u,d={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return d;if(h=m?o:r){if(h.has(i))return h.get(i);h.set(i,d)}for(const p in i)p!=="default"&&{}.hasOwnProperty.call(i,p)&&((u=(h=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,p))&&(u.get||u.set)?h(d,p,u):d[p]=i[p]);return d})(t,a)}let ot="";function ks(t,a){return ot||(ot=(0,J.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,J.isFunction)(t[r])})),(0,J.isFunction)(t[ot])?t[ot](a):!1}function _a(t,a,r){let o=t;do{if(ks(o,a))return!0;if(o===r)return!1;o=o.parentNode}while(o);return!1}function Ia(t,a,r,o){if(!t)return;const i={capture:!0,...o};t.addEventListener?t.addEventListener(a,r,i):t.attachEvent?t.attachEvent("on"+a,r):t["on"+a]=r}function za(t,a,r,o){if(!t)return;const i={capture:!0,...o};t.removeEventListener?t.removeEventListener(a,r,i):t.detachEvent?t.detachEvent("on"+a,r):t["on"+a]=null}function $a(t){let a=t.clientHeight;const r=t.ownerDocument.defaultView.getComputedStyle(t);return a+=(0,J.int)(r.borderTopWidth),a+=(0,J.int)(r.borderBottomWidth),a}function qa(t){let a=t.clientWidth;const r=t.ownerDocument.defaultView.getComputedStyle(t);return a+=(0,J.int)(r.borderLeftWidth),a+=(0,J.int)(r.borderRightWidth),a}function Ha(t){let a=t.clientHeight;const r=t.ownerDocument.defaultView.getComputedStyle(t);return a-=(0,J.int)(r.paddingTop),a-=(0,J.int)(r.paddingBottom),a}function Ua(t){let a=t.clientWidth;const r=t.ownerDocument.defaultView.getComputedStyle(t);return a-=(0,J.int)(r.paddingLeft),a-=(0,J.int)(r.paddingRight),a}function Ka(t,a,r){const i=a===a.ownerDocument.body?{left:0,top:0}:a.getBoundingClientRect(),m=(t.clientX+a.scrollLeft-i.left)/r,h=(t.clientY+a.scrollTop-i.top)/r;return{x:m,y:h}}function Xa(t,a){const r=Ct(t,a,"px");return{[(0,js.browserPrefixToKey)("transform",js.default)]:r}}function Ya(t,a){return Ct(t,a,"")}function Ct(t,a,r){let{x:o,y:i}=t,m=`translate(${o}${r},${i}${r})`;if(a){const h=`${typeof a.x=="string"?a.x:a.x+r}`,u=`${typeof a.y=="string"?a.y:a.y+r}`;m=`translate(${h}, ${u})`+m}return m}function Wa(t,a){return t.targetTouches&&(0,J.findInArray)(t.targetTouches,r=>a===r.identifier)||t.changedTouches&&(0,J.findInArray)(t.changedTouches,r=>a===r.identifier)}function Ba(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function Va(t){if(!t)return;let a=t.getElementById("react-draggable-style-el");a||(a=t.createElement("style"),a.type="text/css",a.id="react-draggable-style-el",a.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,a.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(a)),t.body&&Ts(t.body,"react-draggable-transparent-selection")}function Ga(t){window.requestAnimationFrame?window.requestAnimationFrame(()=>{Ns(t)}):Ns(t)}function Ns(t){if(t)try{if(t.body&&Es(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const a=(t.defaultView||window).getSelection();a&&a.type!=="Caret"&&a.removeAllRanges()}}catch{}}function Ts(t,a){t.classList?t.classList.add(a):t.className.match(new RegExp(`(?:^|\\s)${a}(?!\\S)`))||(t.className+=` ${a}`)}function Es(t,a){t.classList?t.classList.remove(a):t.className=t.className.replace(new RegExp(`(?:^|\\s)${a}(?!\\S)`,"g"),"")}var re={};Object.defineProperty(re,"__esModule",{value:!0});re.canDragX=Za;re.canDragY=er;re.createCoreData=sr;re.createDraggableData=ar;re.getBoundPosition=Ja;re.getControlPosition=tr;re.snapToGrid=Qa;var G=ae,Se=M;function Ja(t,a,r){if(!t.props.bounds)return[a,r];let{bounds:o}=t.props;o=typeof o=="string"?o:rr(o);const i=Dt(t);if(typeof o=="string"){const{ownerDocument:m}=i,h=m.defaultView;let u;if(o==="parent"?u=i.parentNode:u=i.getRootNode().querySelector(o),!(u instanceof h.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');const d=u,p=h.getComputedStyle(i),k=h.getComputedStyle(d);o={left:-i.offsetLeft+(0,G.int)(k.paddingLeft)+(0,G.int)(p.marginLeft),top:-i.offsetTop+(0,G.int)(k.paddingTop)+(0,G.int)(p.marginTop),right:(0,Se.innerWidth)(d)-(0,Se.outerWidth)(i)-i.offsetLeft+(0,G.int)(k.paddingRight)-(0,G.int)(p.marginRight),bottom:(0,Se.innerHeight)(d)-(0,Se.outerHeight)(i)-i.offsetTop+(0,G.int)(k.paddingBottom)-(0,G.int)(p.marginBottom)}}return(0,G.isNum)(o.right)&&(a=Math.min(a,o.right)),(0,G.isNum)(o.bottom)&&(r=Math.min(r,o.bottom)),(0,G.isNum)(o.left)&&(a=Math.max(a,o.left)),(0,G.isNum)(o.top)&&(r=Math.max(r,o.top)),[a,r]}function Qa(t,a,r){const o=Math.round(a/t[0])*t[0],i=Math.round(r/t[1])*t[1];return[o,i]}function Za(t){return t.props.axis==="both"||t.props.axis==="x"}function er(t){return t.props.axis==="both"||t.props.axis==="y"}function tr(t,a,r){const o=typeof a=="number"?(0,Se.getTouch)(t,a):null;if(typeof a=="number"&&!o)return null;const i=Dt(r),m=r.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,Se.offsetXYFromParent)(o||t,m,r.props.scale)}function sr(t,a,r){const o=!(0,G.isNum)(t.lastX),i=Dt(t);return o?{node:i,deltaX:0,deltaY:0,lastX:a,lastY:r,x:a,y:r}:{node:i,deltaX:a-t.lastX,deltaY:r-t.lastY,lastX:t.lastX,lastY:t.lastY,x:a,y:r}}function ar(t,a){const r=t.props.scale;return{node:a.node,x:t.state.x+a.deltaX/r,y:t.state.y+a.deltaY/r,deltaX:a.deltaX/r,deltaY:a.deltaY/r,lastX:t.state.x,lastY:t.state.y}}function rr(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function Dt(t){const a=t.findDOMNode();if(!a)throw new Error("<DraggableCore>: Unmounted during event!");return a}var ct={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.default=nr;function nr(){}Object.defineProperty(ct,"__esModule",{value:!0});ct.default=void 0;var yt=Os(l),H=Rt(Ds),ir=Rt(bs),_=M,he=re,St=ae,qe=Rt(dt);function Rt(t){return t&&t.__esModule?t:{default:t}}function Os(t,a){if(typeof WeakMap=="function")var r=new WeakMap,o=new WeakMap;return(Os=function(i,m){if(!m&&i&&i.__esModule)return i;var h,u,d={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return d;if(h=m?o:r){if(h.has(i))return h.get(i);h.set(i,d)}for(const p in i)p!=="default"&&{}.hasOwnProperty.call(i,p)&&((u=(h=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,p))&&(u.get||u.set)?h(d,p,u):d[p]=i[p]);return d})(t,a)}function U(t,a,r){return(a=or(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function or(t){var a=lr(t,"string");return typeof a=="symbol"?a:a+""}function lr(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var o=r.call(t,a||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}const te={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let pe=te.mouse,mt=class extends yt.Component{constructor(){super(...arguments),U(this,"dragging",!1),U(this,"lastX",NaN),U(this,"lastY",NaN),U(this,"touchIdentifier",null),U(this,"mounted",!1),U(this,"handleDragStart",a=>{if(this.props.onMouseDown(a),!this.props.allowAnyClick&&typeof a.button=="number"&&a.button!==0)return!1;const r=this.findDOMNode();if(!r||!r.ownerDocument||!r.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:o}=r;if(this.props.disabled||!(a.target instanceof o.defaultView.Node)||this.props.handle&&!(0,_.matchesSelectorAndParentsTo)(a.target,this.props.handle,r)||this.props.cancel&&(0,_.matchesSelectorAndParentsTo)(a.target,this.props.cancel,r))return;a.type==="touchstart"&&!this.props.allowMobileScroll&&a.preventDefault();const i=(0,_.getTouchIdentifier)(a);this.touchIdentifier=i;const m=(0,he.getControlPosition)(a,i,this);if(m==null)return;const{x:h,y:u}=m,d=(0,he.createCoreData)(this,h,u);(0,qe.default)("DraggableCore: handleDragStart: %j",d),(0,qe.default)("calling",this.props.onStart),!(this.props.onStart(a,d)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,_.addUserSelectStyles)(o),this.dragging=!0,this.lastX=h,this.lastY=u,(0,_.addEvent)(o,pe.move,this.handleDrag),(0,_.addEvent)(o,pe.stop,this.handleDragStop))}),U(this,"handleDrag",a=>{const r=(0,he.getControlPosition)(a,this.touchIdentifier,this);if(r==null)return;let{x:o,y:i}=r;if(Array.isArray(this.props.grid)){let u=o-this.lastX,d=i-this.lastY;if([u,d]=(0,he.snapToGrid)(this.props.grid,u,d),!u&&!d)return;o=this.lastX+u,i=this.lastY+d}const m=(0,he.createCoreData)(this,o,i);if((0,qe.default)("DraggableCore: handleDrag: %j",m),this.props.onDrag(a,m)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const d=document.createEvent("MouseEvents");d.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(d)}return}this.lastX=o,this.lastY=i}),U(this,"handleDragStop",a=>{if(!this.dragging)return;const r=(0,he.getControlPosition)(a,this.touchIdentifier,this);if(r==null)return;let{x:o,y:i}=r;if(Array.isArray(this.props.grid)){let d=o-this.lastX||0,p=i-this.lastY||0;[d,p]=(0,he.snapToGrid)(this.props.grid,d,p),o=this.lastX+d,i=this.lastY+p}const m=(0,he.createCoreData)(this,o,i);if(this.props.onStop(a,m)===!1||this.mounted===!1)return!1;const u=this.findDOMNode();u&&this.props.enableUserSelectHack&&(0,_.scheduleRemoveUserSelectStyles)(u.ownerDocument),(0,qe.default)("DraggableCore: handleDragStop: %j",m),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,u&&((0,qe.default)("DraggableCore: Removing handlers"),(0,_.removeEvent)(u.ownerDocument,pe.move,this.handleDrag),(0,_.removeEvent)(u.ownerDocument,pe.stop,this.handleDragStop))}),U(this,"onMouseDown",a=>(pe=te.mouse,this.handleDragStart(a))),U(this,"onMouseUp",a=>(pe=te.mouse,this.handleDragStop(a))),U(this,"onTouchStart",a=>(pe=te.touch,this.handleDragStart(a))),U(this,"onTouchEnd",a=>(pe=te.touch,this.handleDragStop(a)))}componentDidMount(){this.mounted=!0;const a=this.findDOMNode();a&&(0,_.addEvent)(a,te.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const a=this.findDOMNode();if(a){const{ownerDocument:r}=a;(0,_.removeEvent)(r,te.mouse.move,this.handleDrag),(0,_.removeEvent)(r,te.touch.move,this.handleDrag),(0,_.removeEvent)(r,te.mouse.stop,this.handleDragStop),(0,_.removeEvent)(r,te.touch.stop,this.handleDragStop),(0,_.removeEvent)(a,te.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,_.scheduleRemoveUserSelectStyles)(r)}}findDOMNode(){var a,r,o;return(a=this.props)!=null&&a.nodeRef?(o=(r=this.props)==null?void 0:r.nodeRef)==null?void 0:o.current:ir.default.findDOMNode(this)}render(){return yt.cloneElement(yt.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};ct.default=mt;U(mt,"displayName","DraggableCore");U(mt,"propTypes",{allowAnyClick:H.default.bool,allowMobileScroll:H.default.bool,children:H.default.node.isRequired,disabled:H.default.bool,enableUserSelectHack:H.default.bool,offsetParent:function(t,a){if(t[a]&&t[a].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:H.default.arrayOf(H.default.number),handle:H.default.string,cancel:H.default.string,nodeRef:H.default.object,onStart:H.default.func,onDrag:H.default.func,onStop:H.default.func,onMouseDown:H.default.func,scale:H.default.number,className:St.dontSetMe,style:St.dontSetMe,transform:St.dontSetMe});U(mt,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),t.default=void 0;var a=K(l),r=k(Ds),o=k(bs),i=Pa,m=M,h=re,u=ae,d=k(ct),p=k(dt);function k(v){return v&&v.__esModule?v:{default:v}}function K(v,f){if(typeof WeakMap=="function")var y=new WeakMap,b=new WeakMap;return(K=function(j,S){if(!S&&j&&j.__esModule)return j;var W,B,$={__proto__:null,default:j};if(j===null||typeof j!="object"&&typeof j!="function")return $;if(W=S?b:y){if(W.has(j))return W.get(j);W.set(j,$)}for(const X in j)X!=="default"&&{}.hasOwnProperty.call(j,X)&&((B=(W=Object.defineProperty)&&Object.getOwnPropertyDescriptor(j,X))&&(B.get||B.set)?W($,X,B):$[X]=j[X]);return $})(v,f)}function O(){return O=Object.assign?Object.assign.bind():function(v){for(var f=1;f<arguments.length;f++){var y=arguments[f];for(var b in y)({}).hasOwnProperty.call(y,b)&&(v[b]=y[b])}return v},O.apply(null,arguments)}function Q(v,f,y){return(f=Z(f))in v?Object.defineProperty(v,f,{value:y,enumerable:!0,configurable:!0,writable:!0}):v[f]=y,v}function Z(v){var f=x(v,"string");return typeof f=="symbol"?f:f+""}function x(v,f){if(typeof v!="object"||!v)return v;var y=v[Symbol.toPrimitive];if(y!==void 0){var b=y.call(v,f||"default");if(typeof b!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(v)}class g extends a.Component{static getDerivedStateFromProps(f,y){let{position:b}=f,{prevPropsPosition:j}=y;return b&&(!j||b.x!==j.x||b.y!==j.y)?((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:b,prevPropsPosition:j}),{x:b.x,y:b.y,prevPropsPosition:{...b}}):null}constructor(f){super(f),Q(this,"onDragStart",(y,b)=>{if((0,p.default)("Draggable: onDragStart: %j",b),this.props.onStart(y,(0,h.createDraggableData)(this,b))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),Q(this,"onDrag",(y,b)=>{if(!this.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",b);const j=(0,h.createDraggableData)(this,b),S={x:j.x,y:j.y,slackX:0,slackY:0};if(this.props.bounds){const{x:B,y:$}=S;S.x+=this.state.slackX,S.y+=this.state.slackY;const[X,Ke]=(0,h.getBoundPosition)(this,S.x,S.y);S.x=X,S.y=Ke,S.slackX=this.state.slackX+(B-S.x),S.slackY=this.state.slackY+($-S.y),j.x=S.x,j.y=S.y,j.deltaX=S.x-this.state.x,j.deltaY=S.y-this.state.y}if(this.props.onDrag(y,j)===!1)return!1;this.setState(S)}),Q(this,"onDragStop",(y,b)=>{if(!this.state.dragging||this.props.onStop(y,(0,h.createDraggableData)(this,b))===!1)return!1;(0,p.default)("Draggable: onDragStop: %j",b);const S={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:B,y:$}=this.props.position;S.x=B,S.y=$}this.setState(S)}),this.state={dragging:!1,dragged:!1,x:f.position?f.position.x:f.defaultPosition.x,y:f.position?f.position.y:f.defaultPosition.y,prevPropsPosition:{...f.position},slackX:0,slackY:0,isElementSVG:!1},f.position&&!(f.onDrag||f.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){var f,y;return((y=(f=this.props)==null?void 0:f.nodeRef)==null?void 0:y.current)??o.default.findDOMNode(this)}render(){const{axis:f,bounds:y,children:b,defaultPosition:j,defaultClassName:S,defaultClassNameDragging:W,defaultClassNameDragged:B,position:$,positionOffset:X,scale:Ke,...Xe}=this.props;let we={},Ce=null;const De=!!!$||this.state.dragging,Re=$||j,Me={x:(0,h.canDragX)(this)&&De?this.state.x:Re.x,y:(0,h.canDragY)(this)&&De?this.state.y:Re.y};this.state.isElementSVG?Ce=(0,m.createSVGTransform)(Me,X):we=(0,m.createCSSTransform)(Me,X);const Ye=(0,i.clsx)(b.props.className||"",S,{[W]:this.state.dragging,[B]:this.state.dragged});return a.createElement(d.default,O({},Xe,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),a.cloneElement(a.Children.only(b),{className:Ye,style:{...b.props.style,...we},transform:Ce}))}}t.default=g,Q(g,"displayName","Draggable"),Q(g,"propTypes",{...d.default.propTypes,axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:u.dontSetMe,style:u.dontSetMe,transform:u.dontSetMe}),Q(g,"defaultProps",{...d.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(ys);const{default:As,DraggableCore:cr}=ys;lt.exports=As;lt.exports.default=As;lt.exports.DraggableCore=cr;var dr=lt.exports;const mr=ea(dr);function ur({equipos:t,equipoSeleccionado:a,onSelect:r,titulo:o="Seleccionar Equipo",descripcion:i="Selecciona un equipo de la lista"}){const[m,h]=l.useState(!1),[u,d]=l.useState(""),p=t.filter(x=>x.activo),k=p.filter(x=>{var g,v;return x.nombre.toLowerCase().includes(u.toLowerCase())||x.ficha.toLowerCase().includes(u.toLowerCase())||((g=x.marca)==null?void 0:g.toLowerCase().includes(u.toLowerCase()))||((v=x.categoria)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))}),K=p.find(x=>x.ficha===a),O=x=>{r(x),h(!1),d("")},Q=x=>{if(!x)return e.jsx(gs,{className:"w-5 h-5"});const g=x.toLowerCase();return g.includes("vehÃ­culo")||g.includes("camion")?e.jsx(ma,{className:"w-5 h-5"}):e.jsx(gs,{className:"w-5 h-5"})},Z=x=>{if(!x)return"bg-gray-100 text-gray-800";const g=x.toLowerCase();return g.includes("excavadora")?"bg-amber-100 text-amber-800":g.includes("vehÃ­culo")?"bg-blue-100 text-blue-800":g.includes("camion")?"bg-green-100 text-green-800":g.includes("rodillo")?"bg-purple-100 text-purple-800":g.includes("retro")?"bg-orange-100 text-orange-800":g.includes("cargador")?"bg-cyan-100 text-cyan-800":"bg-gray-100 text-gray-800"};return e.jsxs(ra,{open:m,onOpenChange:h,children:[e.jsx(na,{asChild:!0,children:e.jsx(z,{variant:"outline",className:"w-full justify-start text-left font-normal h-auto py-3",children:K?e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:`p-2 rounded-lg ${Z(K.categoria)}`,children:Q(K.categoria)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:K.nombre}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[K.ficha," Â· ",K.marca," ",K.modelo]})]}),e.jsx(E,{variant:"outline",children:K.categoria})]}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(wt,{className:"w-4 h-4"}),e.jsx("span",{children:i})]})})}),e.jsxs(ia,{className:"max-w-4xl max-h-[85vh]",children:[e.jsx(oa,{children:e.jsx(la,{className:"text-2xl",children:o})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(wt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Buscar por nombre, ficha, marca o categorÃ­a...",value:u,onChange:x=>d(x.target.value),className:"pl-10"})]}),e.jsx(ca,{className:"h-[500px] pr-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:k.length===0?e.jsx("div",{className:"col-span-2 text-center py-8 text-muted-foreground",children:"No se encontraron equipos"}):k.map(x=>e.jsx(ye,{className:`p-4 cursor-pointer transition-all hover:shadow-lg hover:scale-[1.02] ${a===x.ficha?"ring-2 ring-primary bg-primary/5":"hover:bg-accent"}`,onClick:()=>O(x.ficha),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${Z(x.categoria)}`,children:Q(x.categoria)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-base leading-tight mb-1",children:x.nombre}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[x.marca," ",x.modelo]})]}),a===x.ficha&&e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center",children:e.jsx(da,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx(E,{variant:"secondary",className:"text-xs",children:x.ficha}),x.categoria&&e.jsx(E,{variant:"outline",className:"text-xs",children:x.categoria}),x.numeroSerie&&e.jsxs(E,{variant:"outline",className:"text-xs",children:["S/N: ",x.numeroSerie]})]}),x.placa&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Placa: ",x.placa]})]})]})},x.ficha))})}),k.length>0&&e.jsxs("div",{className:"text-sm text-muted-foreground pt-2 border-t",children:["Mostrando ",k.length," de ",p.length," equipos"]})]})]})]})}const hr=t=>{if(!t)return"Sin registro";const a=new Date(t);return Number.isNaN(a.getTime())?"Sin registro":a.toLocaleDateString()},vs=t=>{var r;if(!t)return"";const a=(r=t.tipoMantenimiento)==null?void 0:r.match(/(PM\d)/i);return a!=null&&a[1]?a[1].toUpperCase():t.frecuencia?t.frecuencia<=250?"PM1":t.frecuencia<=500?"PM2":t.frecuencia<=1e3?"PM3":t.frecuencia<=2e3?"PM4":"":""},pr=()=>{const t=new Date,a=new Date;a.setDate(t.getDate()-6);const r=o=>o.toISOString().split("T")[0];return{desde:r(a),hasta:r(t)}},He=(t,a)=>{const[r,o,i]=t.split("-").map(Number),[m,h,u]=a.split("-").map(Number),d=new Date(r,o-1,i,0,0,0,0),p=new Date(m,h-1,u,23,59,59,999);return Number.isNaN(d.getTime())||Number.isNaN(p.getTime())||d>p?null:{desde:d.toISOString(),hasta:p.toISOString()}};function _r(){var rs;va(),ta();const{data:t,loading:a,updateHorasActuales:r,registrarMantenimientoRealizado:o}=sa(),{toast:i}=aa(),m=l.useMemo(()=>t.equipos.filter(s=>s.activo),[t.equipos]),[h,u]=l.useState(null),[d,p]=l.useState(""),[k,K]=l.useState("all"),[O,Q]=l.useState("all"),[Z,x]=l.useState(null),[g,v]=l.useState(""),[f,y]=l.useState([]),[b,j]=l.useState("mantenimiento"),[S,W]=l.useState(""),[B,$]=l.useState(""),[X,Ke]=l.useState(""),[Xe,we]=l.useState(""),[Ce,ut]=l.useState("horas"),[De,Re]=l.useState(""),[Me,Ye]=l.useState(""),[Mt,Fs]=l.useState(""),[Pt,kt]=l.useState(""),[Tt,Et]=l.useState(""),[Ot,At]=l.useState("horas"),[Ft,Lt]=l.useState(!1),[_t,It]=l.useState(!1),[zt,Ls]=l.useState(!1),[le,fe]=l.useState(()=>localStorage.getItem("reporteDesde")||""),[ce,ge]=l.useState(()=>localStorage.getItem("reporteHasta")||""),[A,je]=l.useState(()=>{const s=localStorage.getItem("reporteRango");return s?JSON.parse(s):null}),[_s,ht]=l.useState(!1),[Ne,$t]=l.useState(""),[T,We]=l.useState(null),[pt,qt]=l.useState(""),[xt,Ht]=l.useState(""),[Ut,Kt]=l.useState(""),[Xt,Yt]=l.useState(""),[Wt,Bt]=l.useState(!1),[Vt,Gt]=l.useState([]),ve=l.useMemo(()=>m.filter(s=>{var n;return(n=s.marca)==null?void 0:n.toLowerCase().includes("cat")}).sort((s,n)=>s.ficha.localeCompare(n.ficha)),[m]);l.useEffect(()=>{if(!a&&t.mantenimientosProgramados.length>0&&!h){const s=t.mantenimientosProgramados.find(n=>m.some(c=>c.ficha===n.ficha));s&&u(s.ficha)}},[a,t.mantenimientosProgramados,h,m]),l.useEffect(()=>{ve.length>0?x(s=>s&&ve.some(n=>n.ficha===s)?s:ve[0].ficha):x(null)},[ve]),l.useEffect(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},[]),l.useEffect(()=>{le&&localStorage.setItem("reporteDesde",le)},[le]),l.useEffect(()=>{ce&&localStorage.setItem("reporteHasta",ce)},[ce]),l.useEffect(()=>{A&&localStorage.setItem("reporteRango",JSON.stringify(A))},[A]),l.useEffect(()=>{if(Ne.trim()){const s=Ne.trim().toUpperCase();let n=t.mantenimientosProgramados.find(c=>c.ficha.toUpperCase()===s);if(!n){const c=s.replace(/-/g,"").replace(/^0+/,"");n=t.mantenimientosProgramados.find(w=>{const N=w.ficha.toUpperCase(),L=N.replace(/-/g,"").replace(/^0+/,"");return L===c||L.includes(c)||c.includes(L)||N.includes(s)})}n?(We(n),qt(n.horasKmActuales.toString()),Ht(new Date().toISOString().slice(0,10))):We(null)}else We(null)},[Ne,t.mantenimientosProgramados]);const Y=l.useMemo(()=>t.mantenimientosProgramados.find(n=>n.ficha===h)??null,[t.mantenimientosProgramados,h]);l.useEffect(()=>{if(Y){W(Y.horasKmActuales.toString()),Ye(Y.horasKmActuales.toString()),$(new Date().toISOString().slice(0,10)),Re(new Date().toISOString().slice(0,10));const s=Y.tipoMantenimiento.toLowerCase().includes("km")?"km":"horas";ut(s),At(s)}},[h,Y]);const Is=l.useMemo(()=>{const s=new Set(m.map(n=>n.categoria).filter(Boolean));return Array.from(s).sort()},[m]),ne=l.useMemo(()=>Z?m.find(s=>s.ficha===Z)??null:null,[m,Z]),ie=l.useMemo(()=>Z?t.mantenimientosProgramados.filter(s=>s.ficha===Z).sort((s,n)=>s.horasKmRestante-n.horasKmRestante):[],[t.mantenimientosProgramados,Z])[0]??null,Be=vs(ie),Jt=((ne==null?void 0:ne.marca)??"").toLowerCase().includes("cat"),{data:de,loading:zs}=ja(Jt?(ne==null?void 0:ne.modelo)??"":"",Jt?(ne==null?void 0:ne.numeroSerie)??"":""),oe=l.useMemo(()=>de.intervalos??[],[de.intervalos]);l.useEffect(()=>{if(oe.length===0){v("");return}v(s=>s&&oe.some(n=>n.codigo===s)?s:Be&&oe.some(n=>n.codigo===Be)?Be:oe[0].codigo)},[oe,Be]);const $s=l.useMemo(()=>{var s;return g?((s=oe.find(n=>n.codigo===g))==null?void 0:s.descripcion)??"No hay descripciÃ³n homologada para este intervalo.":"Selecciona un intervalo para ver el detalle oficial."},[oe,g]),Qt=l.useMemo(()=>{var s;return g?((s=de.tareasPorIntervalo)==null?void 0:s[g])??[]:[]},[de.tareasPorIntervalo,g]),Zt=l.useMemo(()=>{var n;return g?(((n=de.piezasPorIntervalo)==null?void 0:n[g])??[]).map(c=>`${c.pieza.numero_parte} Â· ${c.pieza.descripcion}`):[]},[de.piezasPorIntervalo,g]),ft=l.useMemo(()=>g?(de.mantenimientosEspeciales??[]).filter(s=>s.intervaloCodigo===g):[],[de.mantenimientosEspeciales,g]),qs=((rs=ft[0])==null?void 0:rs.responsableSugerido)??"Define el responsable certificado para este plan",Pe=l.useMemo(()=>{const s=new Map;return t.mantenimientosProgramados.map(n=>{var jt,Ge,Je,ke,ns,is;const c=m.find(ue=>ue.ficha===n.ficha);if(!c||!((jt=c.marca)!=null&&jt.toLowerCase().includes("cat")))return null;const w=vs(n)||"Sin MP";let N=s.get(c.modelo);s.has(c.modelo)||(N=Na(c.modelo),s.set(c.modelo,N??null));const L=w&&((Ge=N==null?void 0:N.tareasPorIntervalo)!=null&&Ge[w])?N.tareasPorIntervalo[w]:[],C=w&&((Je=N==null?void 0:N.piezasPorIntervalo)!=null&&Je[w])?N.piezasPorIntervalo[w].map(ue=>`${ue.pieza.numero_parte} Â· ${ue.pieza.descripcion}`):[],q=w&&(N!=null&&N.intervalos)?((ke=N.intervalos.find(ue=>ue.codigo===w))==null?void 0:ke.descripcion)??"Sin descripciÃ³n":"Sin descripciÃ³n",me=((is=(ns=N==null?void 0:N.mantenimientosEspeciales)==null?void 0:ns.find(ue=>ue.intervaloCodigo===w))==null?void 0:is.responsableSugerido)||"Asignar tÃ©cnico certificado";return{ficha:c.ficha,nombre:c.nombre,categoria:c.categoria,intervalo:w,intervaloDescripcion:q,restante:n.horasKmRestante,proximo:n.proximoMantenimiento,tareas:L,kit:C,capacitacion:me}}).filter(n=>n!==null).sort((n,c)=>n.ficha.localeCompare(c.ficha))},[m,t.mantenimientosProgramados]);l.useEffect(()=>{y(s=>s.filter(n=>Pe.some(c=>c.ficha===n)))},[Pe]);const ee=l.useMemo(()=>g?Pe.filter(s=>s.intervalo===g):Pe,[g,Pe]),Ve=l.useMemo(()=>f.filter(s=>ee.some(n=>n.ficha===s)),[f,ee]).length,Hs=ee.length===0?!1:Ve===ee.length?!0:Ve>0?"indeterminate":!1,Us=s=>{y(n=>n.includes(s)?n.filter(c=>c!==s):[...n,s])},es=s=>{y(s?n=>{const c=new Set(n);return ee.forEach(w=>c.add(w.ficha)),Array.from(c)}:n=>n.filter(c=>!ee.some(w=>w.ficha===c)))},Ks=()=>{y(s=>s.filter(n=>!ee.some(c=>c.ficha===n)))},Xs=l.useMemo(()=>t.mantenimientosProgramados.filter(s=>{const n=m.find(L=>L.ficha===s.ficha);if(!n)return!1;const c=s.ficha.toLowerCase().includes(d.toLowerCase())||s.nombreEquipo.toLowerCase().includes(d.toLowerCase())||((n==null?void 0:n.marca)||"").toLowerCase().includes(d.toLowerCase()),w=k==="all"||((n==null?void 0:n.categoria)||"")===k;let N=!0;if(A&&(O==="registrada"||O==="pendientes")){const L=new Date(s.fechaUltimaActualizacion),C=new Date(A.desde),q=new Date(A.hasta);L.setHours(0,0,0,0),C.setHours(0,0,0,0),q.setHours(23,59,59,999);const me=L>=C&&L<=q;N=O==="registrada"&&me||O==="pendientes"&&!me}else O!=="all"&&O!=="registrada"&&O!=="pendientes"&&(N=O==="critico"&&s.horasKmRestante<=25||O==="alerta"&&s.horasKmRestante>25&&s.horasKmRestante<=50||O==="normal"&&s.horasKmRestante>50);return c&&w&&N}).sort((s,n)=>s.ficha.localeCompare(n.ficha)),[t.mantenimientosProgramados,m,d,k,O,A]),F=l.useMemo(()=>{if(!A)return null;const s=new Date(A.desde),n=new Date(A.hasta);if(Number.isNaN(s.getTime())||Number.isNaN(n.getTime()))return null;const c=t.actualizacionesHorasKm.filter(C=>{const q=new Date(C.fecha);return Number.isNaN(q.getTime())?!1:q>=s&&q<=n}),w=new Map;c.forEach(C=>{const q=w.get(C.ficha)??[];q.push(C),w.set(C.ficha,q)});const N=[],L=[];return t.mantenimientosProgramados.forEach(C=>{const q=new Date(C.fechaUltimaActualizacion);if(Number.isNaN(q.getTime())){L.push(C);return}const me=new Date(q);if(me.setHours(0,0,0,0),me<s||me>n){L.push(C);return}const Ge=(w.get(C.ficha)??[]).find(Je=>{const ke=new Date(Je.fecha);return Number.isNaN(ke.getTime())?!1:ke.toDateString()===q.toDateString()})??null;N.push({mantenimiento:C,evento:Ge})}),{desde:A.desde,hasta:A.hasta,actualizados:N,pendientes:L}},[t.actualizacionesHorasKm,t.mantenimientosProgramados,A]),gt=t.mantenimientosProgramados.filter(s=>m.some(n=>n.ficha===s.ficha)).length,Ys=F&&gt>0?Math.round(F.actualizados.length/gt*100):0,ts=F?F.pendientes.filter(s=>(s.horasKmRestante??0)<=25):[],Ws=t.mantenimientosProgramados.filter(s=>m.some(n=>n.ficha===s.ficha)).slice().sort((s,n)=>s.horasKmRestante-n.horasKmRestante).slice(0,15),Bs=t.mantenimientosProgramados.length>0,Vs=async s=>{if(s.preventDefault(),!!Y){Lt(!0);try{await r({mantenimientoId:Y.id,horasKm:Number(S),fecha:B,usuarioResponsable:X||void 0,observaciones:Xe||void 0,unidad:Ce}),we("")}finally{Lt(!1)}}},Gs=async s=>{if(s.preventDefault(),!!Y){It(!0);try{const n=Tt.split(",").map(c=>c.trim()).filter(Boolean).map(c=>({nombre:c,cantidad:1}));await o({mantenimientoId:Y.id,fecha:De,horasKm:Number(Me),observaciones:Pt||void 0,filtrosUtilizados:n,usuarioResponsable:Mt||void 0,unidad:Ot}),kt(""),Et("")}finally{It(!1)}}},ss=()=>{if(!le||!ce){i({title:"Selecciona el rango",description:"Debes indicar fecha inicial y final",variant:"destructive"});return}const s=He(le,ce);if(!s){i({title:"Rango invÃ¡lido",description:"Verifica las fechas",variant:"destructive"});return}je(s),ht(!0)},as=()=>{je(null),fe(""),ge(""),Q("all"),localStorage.removeItem("reporteRango"),localStorage.removeItem("reporteDesde"),localStorage.removeItem("reporteHasta"),i({title:"Reporte limpiado",description:"Se eliminÃ³ el rango de fechas y filtros"})},Js=async s=>{if(s.preventDefault(),!T)return;const n=T.horasKmActuales,c=Number(pt),w=c-n;Bt(!0);try{const N=T.tipoMantenimiento.toLowerCase().includes("km")?"km":"horas";await r({mantenimientoId:T.id,horasKm:c,fecha:xt,usuarioResponsable:Ut||void 0,observaciones:Xt||void 0,unidad:N});const L={id:`${T.id}-${Date.now()}`,ficha:T.ficha,nombreEquipo:T.nombreEquipo,lecturaAnterior:n,lecturaActual:c,incremento:w,fecha:xt,timestamp:Date.now()};if(Gt(C=>[L,...C].slice(0,50)),"Notification"in window&&Notification.permission==="granted"){const C=N==="km"?"km":"horas";new Notification("ðŸ”” Lectura Actualizada",{body:`${T.ficha} - ${T.nombreEquipo}
Anterior: ${n} ${C}
Actual: ${c} ${C}
Incremento: +${w} ${C}`,icon:"/favicon.ico",badge:"/favicon.ico",tag:T.id.toString(),requireInteraction:!1,silent:!1})}if(i({title:"âœ… Lectura actualizada",description:`${T.nombreEquipo} - ${pt} ${N}`}),$t(""),We(null),Yt(""),Kt(""),A){const C=He(le,ce);C&&je(C)}}catch{i({title:"Error al actualizar",description:"Intenta nuevamente",variant:"destructive"})}finally{Bt(!1)}};return a?e.jsx(Nt,{title:"Control de Mantenimiento",children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(Te,{className:"h-8 w-8 animate-spin text-slate-400"})})}):Bs?e.jsx(Nt,{title:"Control de Mantenimiento",children:e.jsxs(us,{value:b,onValueChange:s=>j(s),className:"space-y-4",children:[e.jsxs(hs,{className:"grid w-full max-w-md grid-cols-2",children:[e.jsxs(nt,{value:"mantenimiento",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Mantenimiento"]}),e.jsxs(nt,{value:"planificador",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Planificador"]})]}),e.jsxs(it,{value:"mantenimiento",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 border rounded-lg bg-slate-50 dark:bg-slate-900 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"Equipos"}),e.jsx("span",{className:"text-xl font-bold",children:gt})]}),e.jsx(ds,{orientation:"vertical",className:"h-6"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"Cobertura"}),e.jsxs("span",{className:"text-xl font-bold text-green-600",children:[Ys,"%"]})]}),e.jsx(ds,{orientation:"vertical",className:"h-6"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"CrÃ­ticos"}),e.jsx("span",{className:Qe("text-xl font-bold",ts.length>0?"text-red-600":"text-slate-400"),children:ts.length})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-[400px,1fr]",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(wt,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),e.jsx(I,{placeholder:"Buscar equipo...",className:"h-9 pl-8 text-sm",value:d,onChange:s=>p(s.target.value)})]}),e.jsxs(Oe,{value:k,onValueChange:K,children:[e.jsx(Ae,{className:"w-32 h-9 text-xs",children:e.jsx(Fe,{placeholder:"CategorÃ­a"})}),e.jsxs(Le,{children:[e.jsx(V,{value:"all",children:"Todas"}),Is.map(s=>e.jsx(V,{value:s,children:s},s))]})]}),e.jsxs(Oe,{value:O,onValueChange:Q,children:[e.jsx(Ae,{className:"w-32 h-9 text-xs",children:e.jsx(Fe,{placeholder:"Estado"})}),e.jsxs(Le,{children:[e.jsx(V,{value:"all",children:"Todos"}),A?e.jsxs(e.Fragment,{children:[e.jsx(V,{value:"registrada",children:"Lectura registrada"}),e.jsx(V,{value:"pendientes",children:"Pendientes"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{value:"critico",children:"CrÃ­tico"}),e.jsx(V,{value:"alerta",children:"Alerta"}),e.jsx(V,{value:"normal",children:"Normal"})]})]})]})]}),e.jsx("div",{className:"rounded-md border bg-white dark:bg-slate-950 max-h-[600px] overflow-auto",children:e.jsxs(Ie,{children:[e.jsx(ze,{className:"sticky top-0 bg-slate-50 dark:bg-slate-900",children:e.jsxs(se,{className:"hover:bg-transparent",children:[e.jsx(D,{className:"h-8 text-xs",children:"Ficha"}),e.jsx(D,{className:"h-8 text-xs",children:"Equipo"}),e.jsx(D,{className:"h-8 text-xs text-right",children:"Restante"}),e.jsx(D,{className:"h-8 w-8"})]})}),e.jsx($e,{children:Xs.map(s=>{var n;return e.jsxs(se,{className:Qe("cursor-pointer h-14 transition-colors",h===s.ficha&&"bg-slate-100 dark:bg-slate-800"),onClick:()=>u(s.ficha),children:[e.jsx(R,{className:"font-mono text-xs py-2",children:s.ficha}),e.jsx(R,{className:"py-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm leading-tight",children:s.nombreEquipo}),e.jsx("div",{className:"text-xs text-slate-500",children:((n=m.find(c=>c.ficha===s.ficha))==null?void 0:n.categoria)||"Sin categorÃ­a"})]})}),e.jsx(R,{className:"text-right py-2",children:e.jsx(E,{variant:be(s.horasKmRestante),className:"text-xs px-1.5",children:s.horasKmRestante})}),e.jsx(R,{className:"py-2",children:e.jsx(ba,{className:"h-4 w-4 text-slate-400"})})]},s.id)})})]})})]}),e.jsx("div",{className:"space-y-4",children:Y&&e.jsxs(ye,{className:"border-slate-200",children:[e.jsx(et,{className:"pb-3 px-4 py-3 border-b bg-slate-50 dark:bg-slate-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(tt,{className:"text-base font-semibold",children:Y.nombreEquipo}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:"outline",className:"font-mono text-xs",children:Y.ficha}),e.jsxs(E,{variant:be(Y.horasKmRestante),className:"text-xs",children:[Y.horasKmRestante," restante"]})]})]})}),e.jsx(Ee,{className:"p-4",children:e.jsxs(us,{defaultValue:"actualizar",className:"space-y-4",children:[e.jsxs(hs,{className:"grid w-full grid-cols-2 h-9",children:[e.jsx(nt,{value:"actualizar",className:"text-sm",children:"Actualizar"}),e.jsx(nt,{value:"registrar",className:"text-sm",children:"Registrar"})]}),e.jsx(it,{value:"actualizar",className:"space-y-3 mt-4",children:e.jsxs("form",{onSubmit:Vs,className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Nueva lectura"}),e.jsx(I,{type:"number",className:"h-9 text-sm",value:S,onChange:s=>W(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Unidad"}),e.jsxs(Oe,{value:Ce,onValueChange:s=>ut(s),children:[e.jsx(Ae,{className:"h-9 text-sm",children:e.jsx(Fe,{})}),e.jsxs(Le,{children:[e.jsx(V,{value:"horas",children:"Horas"}),e.jsx(V,{value:"km",children:"KilÃ³metros"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Fecha"}),e.jsx(I,{type:"date",className:"h-9 text-sm",value:B,onChange:s=>$(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Responsable"}),e.jsx(I,{className:"h-9 text-sm",value:X,onChange:s=>Ke(s.target.value),placeholder:"Opcional"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Observaciones"}),e.jsx(st,{rows:2,className:"text-sm resize-none",value:Xe,onChange:s=>we(s.target.value),placeholder:"Opcional"})]}),e.jsxs(z,{type:"submit",className:"w-full h-9 text-sm",disabled:Ft,children:[Ft?e.jsx(Te,{className:"h-4 w-4 animate-spin mr-2"}):null,"Guardar lectura"]})]})}),e.jsx(it,{value:"registrar",className:"space-y-3 mt-4",children:e.jsxs("form",{onSubmit:Gs,className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Fecha"}),e.jsx(I,{type:"date",className:"h-9 text-sm",value:De,onChange:s=>Re(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Lectura"}),e.jsx(I,{type:"number",className:"h-9 text-sm",value:Me,onChange:s=>Ye(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Unidad"}),e.jsxs(Oe,{value:Ot,onValueChange:s=>At(s),children:[e.jsx(Ae,{className:"h-9 text-sm",children:e.jsx(Fe,{})}),e.jsxs(Le,{children:[e.jsx(V,{value:"horas",children:"Horas"}),e.jsx(V,{value:"km",children:"Km"})]})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Responsable"}),e.jsx(I,{className:"h-9 text-sm",value:Mt,onChange:s=>Fs(s.target.value),placeholder:"TÃ©cnico responsable"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Repuestos (separar por coma)"}),e.jsx(st,{rows:2,className:"text-sm resize-none",value:Tt,onChange:s=>Et(s.target.value),placeholder:"Filtro aceite, Filtro aire, etc."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{className:"text-xs font-medium",children:"Observaciones"}),e.jsx(st,{rows:3,className:"text-sm resize-none",value:Pt,onChange:s=>kt(s.target.value),placeholder:"Detalle del trabajo realizado"})]}),e.jsxs(z,{type:"submit",className:"w-full h-9 text-sm",disabled:_t,children:[_t?e.jsx(Te,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Registrar mantenimiento"]})]})})]})})]})})]}),e.jsx(xa,{open:zt,onOpenChange:Ls,children:e.jsxs(ye,{className:"border-slate-200",children:[e.jsx(fa,{asChild:!0,children:e.jsx(et,{className:"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"text-base font-semibold",children:"Reportes Semanales"}),F&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs(E,{variant:"secondary",children:[F.actualizados.length," actualizados"]}),e.jsxs(E,{variant:"destructive",children:[F.pendientes.length," pendientes"]})]})]}),e.jsx(ua,{className:Qe("h-4 w-4 transition-transform",zt&&"rotate-180")})]})})}),e.jsx(ga,{children:e.jsx(Ee,{className:"p-4 pt-0 space-y-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{type:"date",value:le,onChange:s=>fe(s.target.value),className:"h-9 text-sm"}),e.jsx("span",{className:"text-sm text-slate-500",children:"a"}),e.jsx(I,{type:"date",value:ce,onChange:s=>ge(s.target.value),className:"h-9 text-sm"}),e.jsx(z,{onClick:ss,size:"sm",className:"h-9",children:"Generar"}),A&&e.jsx(z,{onClick:as,size:"sm",variant:"outline",className:"h-9",children:"Limpiar"})]})})})]})}),e.jsxs(ye,{className:"border-slate-200",children:[e.jsx(et,{className:"px-4 py-3 border-b bg-slate-50 dark:bg-slate-900",children:e.jsx(tt,{className:"text-base font-semibold",children:"PrÃ³ximos Mantenimientos"})}),e.jsx(Ee,{className:"p-0",children:e.jsx("div",{className:"overflow-auto max-h-96",children:e.jsxs(Ie,{className:"text-sm",children:[e.jsx(ze,{className:"sticky top-0 bg-slate-50 dark:bg-slate-900",children:e.jsxs(se,{className:"hover:bg-transparent",children:[e.jsx(D,{className:"h-8 text-xs",children:"Equipo"}),e.jsx(D,{className:"h-8 text-xs w-20",children:"Ficha"}),e.jsx(D,{className:"h-8 text-xs w-24 text-right",children:"Lectura"}),e.jsx(D,{className:"h-8 text-xs w-24 text-right",children:"Restante"}),e.jsx(D,{className:"h-8 text-xs w-24 text-right",children:"PrÃ³ximo"})]})}),e.jsx($e,{children:Ws.map(s=>e.jsxs(se,{className:"h-10",children:[e.jsxs(R,{className:"py-1",children:[e.jsx("div",{className:"font-medium text-sm",children:s.nombreEquipo}),e.jsx("div",{className:"text-xs text-slate-500",children:s.tipoMantenimiento})]}),e.jsx(R,{className:"font-mono text-xs py-1",children:s.ficha}),e.jsx(R,{className:"text-right py-1",children:e.jsx("span",{className:"text-sm",children:s.horasKmActuales})}),e.jsx(R,{className:"text-right py-1",children:e.jsx(E,{variant:be(s.horasKmRestante),className:"text-xs px-1",children:s.horasKmRestante})}),e.jsx(R,{className:"text-right py-1",children:e.jsx("span",{className:"text-sm font-medium",children:s.proximoMantenimiento})})]},s.id))})]})})})]})]}),e.jsxs("div",{className:"pointer-events-none fixed bottom-6 right-6 z-40 flex flex-col items-end gap-3",children:[_s&&e.jsx(mr,{handle:".drag-handle",defaultPosition:{x:0,y:0},position:void 0,children:e.jsxs("div",{role:"dialog","aria-modal":"false",className:"pointer-events-auto w-[95vw] max-w-[1400px] overflow-hidden rounded-2xl border border-primary/20 bg-background/95 shadow-2xl backdrop-blur supports-[backdrop-filter]:backdrop-blur",children:[e.jsxs("div",{className:"drag-handle cursor-move flex items-start justify-between gap-4 border-b px-6 py-4 bg-slate-50 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"h-5 w-5 text-slate-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"flex items-center gap-2 text-base font-semibold",children:[e.jsx(vt,{className:"h-5 w-5 text-primary"})," Panel Flotante de GestiÃ³n"]}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Arrastra para mover libremente. Actualiza lecturas y genera reportes sin salir de esta vista."})]})]}),e.jsxs(z,{variant:"ghost",size:"icon",onClick:()=>ht(!1),children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Cerrar panel"})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[400px,1fr] max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"border-r overflow-y-auto px-6 py-6 space-y-4 bg-slate-50/50 dark:bg-slate-900/50",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold mb-1 flex items-center gap-2",children:[e.jsx(ya,{className:"h-4 w-4 text-primary"}),"ActualizaciÃ³n RÃ¡pida"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ingresa la ficha para actualizar la lectura"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"fichaRapida",className:"text-xs font-semibold",children:"Ficha del equipo"}),e.jsx(I,{id:"fichaRapida",placeholder:"Ej: AC-003",value:Ne,onChange:s=>$t(s.target.value.toUpperCase()),className:"h-9 text-sm font-mono",autoComplete:"off"})]}),Ne&&!T&&e.jsxs(_e,{variant:"destructive",className:"py-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(at,{className:"text-sm",children:"Equipo no encontrado"}),e.jsxs(rt,{className:"text-xs",children:['No existe un equipo con la ficha "',Ne,'"']})]}),T&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(ye,{className:"border-primary/30 bg-white dark:bg-slate-950",children:e.jsxs(Ee,{className:"p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:T.nombreEquipo}),e.jsx("p",{className:"text-xs text-muted-foreground",children:T.tipoMantenimiento})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Actual:"}),e.jsx("span",{className:"font-semibold ml-1",children:T.horasKmActuales})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"PrÃ³ximo:"}),e.jsx("span",{className:"font-semibold ml-1",children:T.proximoMantenimiento})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Restante:"}),e.jsx(E,{variant:be(T.horasKmRestante),className:"ml-1 text-xs",children:T.horasKmRestante})]})]})]})}),e.jsxs("form",{onSubmit:Js,className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"lecturaRapida",className:"text-xs font-semibold",children:"Nueva lectura *"}),e.jsx(I,{id:"lecturaRapida",type:"number",value:pt,onChange:s=>qt(s.target.value),className:"h-9 text-sm",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"fechaRapida",className:"text-xs font-semibold",children:"Fecha *"}),e.jsx(I,{id:"fechaRapida",type:"date",value:xt,onChange:s=>Ht(s.target.value),className:"h-9 text-sm",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"responsableRapido",className:"text-xs font-semibold",children:"Responsable"}),e.jsx(I,{id:"responsableRapido",placeholder:"Nombre del responsable",value:Ut,onChange:s=>Kt(s.target.value),className:"h-9 text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"notasRapida",className:"text-xs font-semibold",children:"Observaciones"}),e.jsx(st,{id:"notasRapida",placeholder:"Notas adicionales...",value:Xt,onChange:s=>Yt(s.target.value),className:"text-sm min-h-[60px]",rows:2})]}),e.jsx(z,{type:"submit",className:"w-full gap-2",disabled:Wt,children:Wt?e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 animate-spin"}),"Actualizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"h-4 w-4"}),"Actualizar Lectura"]})})]})]})]}),Vt.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h5",{className:"text-xs font-semibold flex items-center gap-2",children:[e.jsx(ms,{className:"h-3.5 w-3.5 text-amber-500"}),"Alertas de ActualizaciÃ³n"]}),e.jsx(z,{variant:"ghost",size:"sm",className:"h-6 text-xs",onClick:()=>Gt([]),children:"Limpiar"})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Vt.map(s=>e.jsx(_e,{className:"py-2 bg-amber-50 dark:bg-amber-950/20 border-amber-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-amber-600 mt-0.5"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-semibold",children:[s.ficha," - ",s.nombreEquipo]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.timestamp).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Anterior:"}),e.jsx("p",{className:"font-semibold",children:s.lecturaAnterior})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Actual:"}),e.jsx("p",{className:"font-semibold text-green-600",children:s.lecturaActual})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Incremento:"}),e.jsxs("p",{className:"font-semibold text-blue-600",children:["+",s.incremento]})]})]})]})]})},s.id))})]})]}),e.jsxs("div",{className:"overflow-y-auto px-6 py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold mb-1 flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4 text-primary"}),"Reportes por Rango"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Genera reportes de actualizaciones por perÃ­odo"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"reporteDesde",className:"font-semibold text-sm",children:"Desde"}),e.jsx(I,{id:"reporteDesde",type:"date",value:le,onChange:s=>fe(s.target.value),className:"h-9"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"reporteHasta",className:"font-semibold text-sm",children:"Hasta"}),e.jsx(I,{id:"reporteHasta",type:"date",value:ce,onChange:s=>ge(s.target.value),className:"h-9"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(z,{type:"button",size:"sm",variant:"secondary",onClick:()=>{const s=pr();fe(s.desde),ge(s.hasta);const n=He(s.desde,s.hasta);n&&je(n)},children:"Ãšltima semana"}),e.jsx(z,{type:"button",size:"sm",variant:"secondary",onClick:()=>{const s=new Date,n=new Date(s);n.setDate(n.getDate()-7),fe(n.toISOString().slice(0,10)),ge(s.toISOString().slice(0,10));const c=He(n.toISOString().slice(0,10),s.toISOString().slice(0,10));c&&je(c)},children:"Ãšltimos 7 dÃ­as"}),e.jsx(z,{type:"button",size:"sm",variant:"secondary",onClick:()=>{const s=new Date,n=new Date(s.getFullYear(),s.getMonth(),1);fe(n.toISOString().slice(0,10)),ge(s.toISOString().slice(0,10));const c=He(n.toISOString().slice(0,10),s.toISOString().slice(0,10));c&&je(c)},children:"Este mes"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(z,{type:"button",onClick:ss,className:"flex-1 gap-2",children:[e.jsx(fs,{className:"h-4 w-4"}),"Generar reporte"]}),A&&e.jsxs(z,{type:"button",onClick:as,variant:"outline",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),"Limpiar"]})]})]}),F?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(E,{variant:"secondary",children:["Actualizados: ",F.actualizados.length]}),e.jsxs(E,{variant:F.pendientes.length>0?"destructive":"outline",children:["Pendientes: ",F.pendientes.length]}),e.jsxs(E,{variant:"outline",children:["PerÃ­odo: ",new Date(F.desde).toLocaleDateString()," - ",new Date(F.hasta).toLocaleDateString()]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Equipos con lectura registrada"}),F.actualizados.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay registros en el rango seleccionado."}):e.jsx("div",{className:"rounded-md border overflow-auto max-h-64",children:e.jsxs(Ie,{className:"text-sm",children:[e.jsx(ze,{className:"sticky top-0 bg-slate-50 dark:bg-slate-900",children:e.jsxs(se,{children:[e.jsx(D,{className:"text-xs h-8",children:"Equipo"}),e.jsx(D,{className:"text-xs h-8",children:"Ficha"}),e.jsx(D,{className:"text-xs h-8",children:"Ãšltima lectura"}),e.jsx(D,{className:"text-xs h-8",children:"Responsable"})]})}),e.jsx($e,{children:F.actualizados.map(({mantenimiento:s,evento:n})=>e.jsxs(se,{className:"h-10",children:[e.jsx(R,{className:"font-medium",children:s.nombreEquipo}),e.jsx(R,{className:"font-mono text-xs",children:s.ficha}),e.jsx(R,{className:"text-xs",children:n?`${n.horasKm} h/km â€¢ ${new Date(n.fecha).toLocaleDateString()}`:"Sin detalle"}),e.jsx(R,{className:"text-xs",children:(n==null?void 0:n.usuarioResponsable)??"No registrado"})]},s.id))})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Equipos pendientes"}),F.pendientes.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Todos los equipos tienen lectura en el rango."}):e.jsx("div",{className:"rounded-md border overflow-auto max-h-64",children:e.jsxs(Ie,{className:"text-sm",children:[e.jsx(ze,{className:"sticky top-0 bg-slate-50 dark:bg-slate-900",children:e.jsxs(se,{children:[e.jsx(D,{className:"text-xs h-8",children:"Equipo"}),e.jsx(D,{className:"text-xs h-8",children:"Ficha"}),e.jsx(D,{className:"text-xs h-8",children:"Ãšltima act."}),e.jsx(D,{className:"text-xs h-8",children:"Horas/km"})]})}),e.jsx($e,{children:F.pendientes.map(s=>e.jsxs(se,{className:"h-10",children:[e.jsx(R,{className:"font-medium",children:s.nombreEquipo}),e.jsx(R,{className:"font-mono text-xs",children:s.ficha}),e.jsx(R,{className:"text-xs",children:hr(s.fechaUltimaActualizacion)}),e.jsx(R,{className:"text-xs",children:s.horasKmActuales})]},s.id))})]})})]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completa el rango y genera el reporte para revisar el estado de las lecturas."})]})]})]})}),e.jsxs(z,{className:"pointer-events-auto h-14 w-14 rounded-full shadow-lg transition hover:scale-105",onClick:()=>ht(s=>!s),size:"icon",children:[e.jsx(vt,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Alternar resumen de actualizaciones"})]})]})]}),e.jsx(it,{value:"planificador",className:"space-y-4",children:e.jsxs(ye,{className:"border-slate-200",children:[e.jsxs(et,{className:"px-4 py-3 border-b bg-slate-50 dark:bg-slate-900",children:[e.jsxs(tt,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5"}),"Planificador Preventivo Caterpillar"]}),e.jsx(ha,{className:"text-sm",children:"Selecciona tu equipo Caterpillar e intervalo para ver tareas, kits y rutas sugeridas"})]}),e.jsx(Ee,{className:"p-4",children:ve.length===0?e.jsxs(_e,{children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(at,{children:"Sin equipos Caterpillar"}),e.jsx(rt,{children:"Registra equipos Caterpillar para habilitar la planificaciÃ³n inteligente de rutas preventivas."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"planFicha",children:"Equipo Caterpillar"}),e.jsx(ur,{equipos:ve,equipoSeleccionado:Z??void 0,onSelect:s=>x(s),titulo:"Seleccionar Equipo Caterpillar",descripcion:"Selecciona un equipo Caterpillar"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"planIntervalo",children:"Intervalo oficial"}),e.jsxs(Oe,{value:g,onValueChange:s=>v(s),disabled:oe.length===0,children:[e.jsx(Ae,{id:"planIntervalo",children:e.jsx(Fe,{placeholder:"Selecciona MP"})}),e.jsx(Le,{children:oe.map(s=>e.jsxs(V,{value:s.codigo,children:[s.codigo," Â· ",s.nombre]},s.codigo))})]})]})]}),zs&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Te,{className:"h-4 w-4 animate-spin"})," Consultando catÃ¡logo Caterpillar..."]}),e.jsxs("div",{className:"grid gap-3 grid-cols-2 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg border p-3 bg-slate-50 dark:bg-slate-900",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Lectura actual"}),e.jsx("p",{className:"text-lg font-semibold",children:ie?`${ie.horasKmActuales}`:"N/A"})]}),e.jsxs("div",{className:"rounded-lg border p-3 bg-slate-50 dark:bg-slate-900",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"PrÃ³ximo objetivo"}),e.jsx("p",{className:"text-lg font-semibold",children:ie?`${ie.proximoMantenimiento}`:"N/A"})]}),e.jsxs("div",{className:"rounded-lg border p-3 bg-slate-50 dark:bg-slate-900",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Restante"}),e.jsx(E,{variant:ie?be(ie.horasKmRestante):"outline",className:"text-sm",children:ie?`${ie.horasKmRestante}`:"N/A"})]}),e.jsxs("div",{className:"rounded-lg border p-3 bg-slate-50 dark:bg-slate-900",children:[e.jsxs("p",{className:"flex items-center gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(Sa,{className:"h-3 w-3"})," CapacitaciÃ³n"]}),e.jsx("p",{className:"text-xs font-medium leading-snug",children:qs})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed p-4 bg-slate-50/50 dark:bg-slate-900/50",children:[e.jsxs("p",{className:"text-sm font-semibold mb-1",children:["DescripciÃ³n ",g||"del intervalo"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:$s})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-[1.5fr,1fr]",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("p",{className:"flex items-center gap-2 text-sm font-semibold mb-3",children:[e.jsx(pa,{className:"h-4 w-4 text-primary"})," Tareas clave"]}),Qt.length>0?e.jsx("ul",{className:"space-y-2 text-sm",children:Qt.map((s,n)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-primary flex-shrink-0"}),e.jsx("span",{className:"leading-snug",children:s})]},n))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Selecciona un intervalo para ver el checklist."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("p",{className:"flex items-center gap-2 text-sm font-semibold mb-3",children:[e.jsx(xs,{className:"h-4 w-4 text-primary"})," Kit recomendado"]}),Zt.length>0?e.jsx("ul",{className:"space-y-1 text-xs",children:Zt.map((s,n)=>e.jsx("li",{className:"leading-snug text-muted-foreground",children:s},n))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay repuestos para este intervalo."})]}),ft.length>0&&e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50/60 dark:bg-amber-950/20 p-4",children:[e.jsxs("p",{className:"font-semibold text-sm text-amber-800 dark:text-amber-300 flex items-center gap-2 mb-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"Mantenimiento especial"]}),e.jsx("ul",{className:"space-y-1 text-sm text-amber-800 dark:text-amber-300",children:ft.map(s=>e.jsx("li",{className:"leading-snug",children:s.descripcion},s.id))})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"font-semibold",children:["Ruta sugerida ",g?`â€¢ ${g}`:""]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(E,{variant:"outline",className:"text-sm",children:[ee.length," equipos"]}),e.jsxs(E,{variant:"secondary",className:"text-sm",children:[Ve," marcados"]}),e.jsx(z,{type:"button",size:"sm",variant:"outline",onClick:()=>es(!0),disabled:ee.length===0,children:"Seleccionar todos"}),e.jsx(z,{type:"button",size:"sm",variant:"ghost",onClick:Ks,disabled:Ve===0,children:"Limpiar"})]})]}),ee.length===0?e.jsxs(_e,{children:[e.jsx(at,{children:"Sin equipos en ruta"}),e.jsx(rt,{children:"No hay equipos Caterpillar con programaciÃ³n activa para este intervalo."})]}):e.jsx("div",{className:"rounded-md border overflow-auto max-h-96",children:e.jsxs(Ie,{children:[e.jsx(ze,{className:"sticky top-0 bg-slate-50 dark:bg-slate-900",children:e.jsxs(se,{className:"hover:bg-transparent",children:[e.jsx(D,{className:"w-10 h-8",children:e.jsx(ps,{checked:Hs,onCheckedChange:s=>es(!!s),"aria-label":"Seleccionar ruta"})}),e.jsx(D,{className:"h-8 text-xs",children:"Equipo"}),e.jsx(D,{className:"h-8 text-xs",children:"Intervalo"}),e.jsx(D,{className:"h-8 text-xs text-right",children:"Restante"}),e.jsx(D,{className:"h-8 text-xs",children:"PrÃ³ximo"}),e.jsx(D,{className:"h-8 text-xs",children:"CapacitaciÃ³n"})]})}),e.jsx($e,{children:ee.map((s,n)=>{const c=f.includes(s.ficha);return e.jsxs(se,{className:Qe("hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors h-14",c&&"bg-primary/5"),children:[e.jsx(R,{className:"py-2",children:e.jsx(ps,{checked:c,onCheckedChange:()=>Us(s.ficha),"aria-label":`Marcar ${s.ficha}`})}),e.jsxs(R,{className:"py-2",children:[e.jsx("div",{className:"font-medium text-sm",children:s.nombre}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.ficha," â€¢ ",s.categoria]})]}),e.jsxs(R,{className:"py-2",children:[e.jsx(E,{variant:"secondary",className:"text-xs",children:s.intervalo}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground leading-snug",children:[s.intervaloDescripcion.slice(0,30),"..."]})]}),e.jsx(R,{className:"text-right py-2",children:e.jsx(E,{variant:be(s.restante),className:"text-xs font-semibold",children:s.restante})}),e.jsx(R,{className:"font-medium text-sm py-2",children:s.proximo}),e.jsxs(R,{className:"text-xs leading-snug py-2",children:[s.capacitacion.slice(0,25),"..."]})]},`${s.ficha}-${n}`)})})]})})]})]})})]})})]})}):e.jsx(Nt,{title:"Control de Mantenimiento",children:e.jsxs(_e,{children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(at,{children:"Sin mantenimientos programados"}),e.jsx(rt,{children:"Define al menos un plan de mantenimiento para comenzar."})]})})}export{_r as default};
